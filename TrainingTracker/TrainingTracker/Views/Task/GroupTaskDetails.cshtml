
@{
    ViewBag.Title = "addComment";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model TrainingTracker.Models.GroupTasks_Details
@using TrainingTracker.HelpingClasses
@using TrainingTracker.Models
@using TrainingTracker.BL
@using RusticiSoftware.HostedEngine.Client;

@{
    CheckAuthenticationDTO logedinuser = General_Purpose.CheckAuthentication();
    Company Company = new CompanyBL().getCompanyById(Convert.ToInt32(logedinuser.Company));
    Course_UserTask cou = new Course_UserTask();
}

<style>
    .dropdown-menu-right {
        left: 0;
        right: 0;
    }

    #info th {
        width: 40% !important;
    }

    #info td {
        width: 60% !important;
    }

    #backbtn {
        margin-left: 20px;
    }

    .filediv:hover {
        background-color: #F5F5F5;
    }

    .dataTables_filter {
        display: none;
    }

    /* Wajeeh custom css for selecting location starts */

    .my-custom-scrollbar {
        position: relative;
        height: 450px;
        overflow: auto;
    }

    .table-wrapper-scroll-y {
        display: block;
    }

    .iconStyle {
        font-size: xx-large;
        margin-right: 2px;
    }

    /* Wajeeh custom css for selecting location ends */
</style>
@{
    if (ViewBag.isModal == "-10" && ViewBag.DxM == "nvgh")
    {
        <!--Bread Crumb line-->
        <div class="bg-white">
            <div class="breadcrumb-line">
                <a class="breadcrumb-elements-toggle"><i class="icon-menu-open"></i></a>
                <ul class="breadcrumb">
                    <li class="active"><a href="@ProjectVaraiables.DocM_URL"><i class="icon-home2 position-left"></i> Document Manager</a></li>
                    <li>@Model.GroupTask.Name</li>

                </ul>
            </div>
        </div>
        <!--Bread Crumb line-->
        <br />
        <a id="backbtn" class="btn btn-sm bg-primary" href="@ProjectVaraiables.DocM_URL">Back</a>
    }
    else if (ViewBag.page == "0")
    {
        <!--Bread Crumb line-->
        <div class="bg-white">
            <div class="breadcrumb-line">
                <a class="breadcrumb-elements-toggle"><i class="icon-menu-open"></i></a>
                <ul class="breadcrumb">
                    <li><a href="@Url.Action("Index","Auth")"><i class="icon-home2 position-left"></i> Home</a></li>
                    <li class="active">Assignments</li>
                    @if (Model.CourseId == null)
                    {
                        <li class="active"><a href="@Url.Action("groupAssignments", "Task")">Group Tasks</a></li>

                    }
                    else
                    {
                        <li class="active"><a href="@Url.Action("groupStudyAssignments", "Task")">Group Study</a></li>
                    }
                    <li class="active">@Model.GroupTask.Name</li>
                </ul>
            </div>
        </div>
        <!--Bread Crumb line-->
        <br />
        <a id="backbtn" class="btn btn-sm bg-primary pull-left" href="@Url.Action("groupAssignments", "Task")">Back</a>
    }
    else if (ViewBag.isModal == "11")
    {

        <!--Bread Crumb line-->
        <div class="bg-white">
            <div class="breadcrumb-line">
                <a class="breadcrumb-elements-toggle"><i class="icon-menu-open"></i></a>
                <ul class="breadcrumb">
                    <li><a href="@Url.Action("Index","Auth")"><i class="icon-home2 position-left"></i> Home</a></li>
                    @if (Model.CourseId == null)
                    {
                        <li class="active">Completed Assignments</li>
                        <li class="active"><a href="@Url.Action("CompletedgroupAssignments", "Task")">Group Tasks</a></li>
                    }
                    else
                    {
                        <li class="active">Completed Assignments</li>
                        <li class="active"><a href="@Url.Action("CompletedgroupStudyAssignments", "Task")">Group Study</a></li>
                    }

                    <li class="active">@Model.GroupTask.Name</li>
                </ul>
            </div>
        </div>
        <!--Bread Crumb line-->
        <br />
        <a id="backbtn" class="btn btn-sm bg-primary pull-left" href="@Url.Action("CompletedgroupAssignments", "Task")">Back</a>
    }
    else
    {
        <!--Bread Crumb line-->
        <div class="bg-white">
            <div class="breadcrumb-line">
                <a class="breadcrumb-elements-toggle"><i class="icon-menu-open"></i></a>
                <ul class="breadcrumb">
                    <li><a href="@Url.Action("Index","Auth")"><i class="icon-home2 position-left"></i> Home</a></li>
                    <li class="active">@Model.GroupTask.Name</li>
                </ul>
            </div>
        </div>
        <!--Bread Crumb line-->
        <br />
        <a id="backbtn" class="btn btn-sm bg-primary pull-left" href="@Url.Action("Index", "Auth")">Back</a>
    }

    GroupTask_User primel;
    primel = Model.GroupTask_User.Where(x => x.IsActive == 1 && x.LeadRole == 1).FirstOrDefault();
    int isprime = 0;
    if (logedinuser.Role == 1)
    {
        if (primel != null)
        {
            isprime = 1;
        }
    }
    else
    {
        isprime = 1;
    }
}
<input type="hidden" value="@isprime" id="IsPrime" />

<div id="SwitchGStudyLeader" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" novalidate method="post" action="@Url.Action("SwitchGroupStudyLeader", "Task")">

                <input type="hidden" name="isModal" value="@ViewBag.page" />
                <input type="hidden" name="gtdId" value="@Model.Id" />


                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Switch Group Study Leader</h4>
                </div>
                <div class="modal-body">



                   

                    <div class="form-group col-md-12">
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Group Study Members</label>
                            <select class="form-control required select-results-color" name="UserId">
                                <option value="">Select a member</option>
                                @if(Company.IsLMS==1 && Model.CourseId != null)
                                {
                                    List<GroupTask_User> gtu = new GroupTask_UserBL().getGroupTask_UsersList().Where(x => x.GroupTaskDetailsId == Model.Id && x.IsActive==1).ToList();
                                    foreach(GroupTask_User item in gtu)
                                    {
                                        if (item.User.Role != 3 && item.UserId!=logedinuser.Id)
                                        {
                                            <option value="@item.UserId">@item.User.FirstName&nbsp;@item.User.LastName</option>
                                        }
                                    }

                                }
                            </select>
                        </div>
                        
                    </div>

                    @*Set Reminder  Divs End *@

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="Rsubmit" class="btn btn-sm  bg-primary">Switch</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="SetPrimeLead" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="@Url.Action("addGroupMember", "Task", new { isModal = ViewBag.pages })">
                <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                <input type="hidden" name="groupTaskDetailsId" value="@Model.Id" />
                <input type="hidden" name="type" value="1" />

                <div class="modal-header  bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <center> <h3 class="modal-title">Add Prime Lead</h3></center>



                </div>
                <div class="modal-body">
                    <br />
                    <div class="form-group">
                        <ul>
                            <li>The Primary Lead of this group task has been removed from the system</li>
                            <li>There are certain operations in the group task that cannot be performed without any Primary Lead.</li>
                            <li>Please assign a Primary Lead to this group task from the list of the users below.</li>
                        </ul>
                    </div>
                    <div class="form-group">
                        <label class="col-lg-12 control-label"><b>User's List:</b><span style="color:red">*</span></label>
                        <div class="col-lg-12">

                            <select class="select" name="sid" id="mang" required>
                                <option selected disabled value="">Please Select Manager</option>
                                @foreach (User itemss in ViewBag.mang)
                                {
                                    if (Model.GroupTask_User.Where(x => x.UserId == itemss.Id && x.IsActive == 1).Count() == 0)
                                    {
                                        <option value="@itemss.Id">@itemss.FirstName &nbsp; @itemss.LastName</option>
                                    }

                                }


                            </select>

                        </div>
                    </div>
                    <br />
                </div>

                <div class="modal-footer">
                    <br />
                    <center class="mt-20">
                        <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">Cancel</button>
                        <button type="submit" id="sbbutton1" class="btn btn-sm  btn-danger">Add</button>
                        <br />


                    </center>
                    <br />
                </div>

            </form>
        </div>
    </div>
</div>

<div id="GroupTaskReminder" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" novalidate method="post" action="@Url.Action("SetGroupTaskReminder", "Task")">

                <input type="hidden" name="isModal" value="@ViewBag.page" />


                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Set Reminder</h4>
                </div>
                <div class="modal-body">



                    @*Set Reminder  Divs Start *@

                    @{ DateTime dt = DateTime.Now; }

                    <input type="hidden" name="GroupTasks_DetailsID" value="@Model.Id" />
                    <input type="hidden" name="UserID" value="@logedinuser.Id" />


                    <label class="control-label col-lg-3"><b>Reminder DateTime</b></label>

                    <div class="form-group col-md-12">
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Reminde Date</label>
                            <input type="date" name="ReminderTime" class="form-control" value="" min="@dt.ToString("yyyy-MM-dd")" max="@Model.EndDate.Value.ToString("yyyy-MM-dd")" required />
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Time</label>
                            <input id="sdtimepicker7" type="text" name="Time" class="form-control input-small" required>

                        </div>



                    </div>

                    @*Set Reminder  Divs End *@

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="Rsubmit" class="btn btn-sm  bg-primary">Set</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="UpdateGroupTaskReminder" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" novalidate method="post" action="@Url.Action("UpdateGroupTaskReminder", "Task")">


                <input type="hidden" name="isModal" value="@ViewBag.page" />


                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Update Reminder</h4>
                </div>
                <div class="modal-body">



                    @*Set Reminder  Divs Start *@

                    @{ DateTime dt2 = DateTime.Now; }

                    <input type="hidden" id="updategrptaskid" name="Id" />
                    <input type="hidden" name="GroupTasks_DetailsID" value="@Model.Id" />
                    <input type="hidden" name="UserID" value="@logedinuser.Id" />


                    <div class="form-group col-md-12">
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Reminde Date</label>
                            <input type="date" id="updatereminder" name="ReminderTime" class="form-control" value="" min="@dt.ToString("yyyy-MM-dd")" max="@Model.EndDate.Value.ToString("yyyy-MM-dd")" required />
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Time</label>
                            <input id="edittimepicker7" type="text" name="Time" class="form-control input-small" maxlength="150" required>

                        </div>



                    </div>

                    @*Set Reminder  Divs End *@

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="Rsubmit" class="btn btn-sm  bg-primary">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="offgrouptaskreminder" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="@Url.Action("OffGroupTaskReminder","Task")">
                <div class="modal-header  bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <br />
                </div>
                <input type="hidden" name="isModal" value="@ViewBag.page" />

                <div class="modal-body">
                    <div class="text-center">
                        <div class="icon-object border-slate-300 text-slate-300"><i class="icon-folder-upload"></i></div>
                        <h5 class="content-group">Are you sure you would like to Remove Reminder?<small class="display-block"></small></h5>
                    </div>
                </div>
                s
                <input type="hidden" name="Id" id="offgrptaskid" />
                <center>
                    <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">No</button>
                    <button type="submit" class="btn btn-sm  btn-danger">Yes</button>
                    <br />


                </center>
                <br />
            </form>
        </div>
    </div>
</div>

<div id="deleteFreqUtask" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header  bg-primary">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <br />
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <div class="icon-object border-slate-300 text-slate-300"><i class="icon-folder-upload"></i></div>
                    <h5 class="content-group">Are you sure you would like to delete the Group task?<small class="display-block"></small></h5>
                </div>
            </div>

            <input type="hidden" id="UtaskId" value="-1" />
            <center>
                <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">No</button>
                <button type="submit" id="sbbutton1" onclick="RemoveFreqTsk()" class="btn btn-sm  btn-danger">Yes</button>
                <br />


            </center>
            <br />

        </div>
    </div>
</div>

<div id="increaseFreqTask" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="@Url.Action("increaseFreqgrpTask","Task")">
                <div class="modal-header  bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <center> <h3 class="modal-title">Increase Frequency</h3></center>



                </div>
                <div class="modal-body">
                    <br />
                    <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                    @*<input type="hidden" name="way" value="@ViewBag.way" />
                        <input type="hidden" name="department" value="@ViewBag.department" />
                        <input type="hidden" name="sid" value="@ViewBag.sid" />
                        <input type="hidden" name="DivDepID" id="DivDepID" value="@ViewBag.DivDepID" />*@
                    <input type="hidden" name="taskId" value="@General_Purpose.EncryptId(Model.Id)" />
                    <div class="form-group">
                        <label class="col-lg-4 control-label">Frequency Ending Date:<span style="color:red">*</span></label>
                        <div class="col-lg-8">


                            <input type="date" name="FeqEndingDate" required />
                        </div>
                    </div>
                    <br />
                </div>

                <input type="hidden" id="UtaskId" value="-1" />
                <p style="color:red; margin-left:50px">Frequency ending date should be greater than start date of last recursive task.</p>
                <center>
                    <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">Cancel</button>
                    <button type="submit" id="sbbutton1" class="btn btn-sm  btn-danger">Submit</button>
                    <br />


                </center>
                <br />
            </form>
        </div>
    </div>
</div>

<div id="removegrpmember" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header  bg-primary">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <br />
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <div class="icon-object border-slate-300 text-slate-300"><i class="icon-folder-upload"></i></div>
                    <h5 class="content-group">Are you sure you would like to remove this member?<small class="display-block"></small></h5>
                </div>
            </div>

            <input type="hidden" id="UserId" value="-1" />
            <input type="hidden" value="@Model.Id" id="groupTaskDetailsId" />

            <center>
                <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">No</button>
                <button type="submit" id="sbbutton1" onclick="RemoveMember()" class="btn btn-sm  btn-danger">Yes</button>
                <br />


            </center>
            <br />

        </div>
    </div>
</div>

<div id="addmemberModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" novalidate method="post" action="@Url.Action("addGroupMember", "Task", new { isModal = ViewBag.pages })">
                <input type="hidden" name="isModal" id="isModal" value="@ViewBag.isModal" />
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Add Member</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group col-md-12">
                        <label class="control-label">Select Type</label>
                        <select class="select" name="type" onchange="displayEmp(this.value)" required>
                            <option selected disabled value="">Please select Type</option>
                            @if (logedinuser.Role == 1)
                            {
                                <option value="3">Admin</option>
                            }
                            <option value="1">Manager</option>
                            <option value="2">Employee</option>


                        </select>
                        <br />
                        <br />
                        <input type="hidden" value="@Model.Id" name="groupTaskDetailsId" />
                        <div id="divemp" style="display:none;">
                            <select class="select" name="sid" id="emp" hidden>
                                <option selected disabled value="">Please Select Employee</option>
                                @foreach (User itemss in ViewBag.emp)
                                {
                                    if (Model.GroupTask_User.Where(x => x.UserId == itemss.Id && x.IsActive == 1).Count() == 0)
                                    {
                                        <option value="@itemss.Id">@itemss.FirstName @itemss.LastName</option>
                                    }

                                }


                            </select>
                        </div>

                        <div id="divmang" style="display: none">
                            <select class="select" name="sid" id="mang" required>
                                <option selected disabled value="">Please Select Manager</option>
                                @foreach (User itemss in ViewBag.mang)
                                {
                                    if (Model.GroupTask_User.Where(x => x.UserId == itemss.Id && x.IsActive == 1).Count() == 0)
                                    {
                                        <option value="@itemss.Id">@itemss.FirstName &nbsp; @itemss.LastName</option>
                                    }

                                }


                            </select>
                        </div>

                        <div id="divadmin" style="display: none">
                            <select class="select" name="sid" id="admin" required>
                                <option selected disabled value="">Please Select Admin</option>
                                @{
                                    List<User> ulist = new UserBL().getAdminList();
                                }
                                @foreach (User itemss in ulist)
                                {
                                    if (Model.GroupTask_User.Where(x => x.UserId == itemss.Id && x.IsActive == 1).Count() == 0)
                                    {
                                        <option value="@itemss.Id">@itemss.FirstName @itemss.LastName</option>
                                    }

                                }


                            </select>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-sm  bg-primary-400">Add</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="statusModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" method="post" action="@Url.Action("updateGroupStatus", "Task" )">
                <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                <input type="hidden" name="cStatus" value="@ViewBag.currentStatus" />
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Change Status</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group col-md-12">
                        <label class="control-label">Status</label>
                        <select onchange="checkstatus()" id="status" class="select" name="status" required>
                            @*<option selected value="@ViewBag.currentStatus">@General_Purpose.getStatusValue((int)ViewBag.currentStatus)</option>*@

                            @foreach (var item in ViewBag.status)
                            {
                                if (ViewBag.currentStatus == item)
                                {
                                    <option selected value="@item">@General_Purpose.getStatusValue((int)item)</option>
                                }
                                else
                                {
                                    <option value="@item">@General_Purpose.getStatusValue((int)item)</option>
                                }


                            }


                        </select>
                    </div>
                    <input type="hidden" value="@Model.Id" name="grouptaskId" />
                    <input type="hidden" value="@ViewBag.ActiveToDo" id="ActiveToDo" />
                </div>
                <div class="modal-footer">
                    <p id="statuswarn" style="color:red"></p>
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-sm  bg-primary-400">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="todoModal" class="modal fade">
    <input type="hidden" value="@Model.StartDate.Value.ToString("yyyy-MM-dd")" id="TaskStartDate" />
    <input type="hidden" value="@Model.EndDate.Value.ToString("yyyy-MM-dd")" id="TaskEndDate" />
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" method="post" action="@Url.Action("addtoDO", "Task")" enctype="multipart/form-data">
                <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Add To Do</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group col-md-12">
                        <label class="control-label"><span style="color:red">*</span>Name</label>
                        <input type="text" name="Name" class="form-control" maxlength="150" required />

                        <input type="hidden" value="@Model.Id" name="GroupTaskDetails_Id" />
                    </div>

                    <div class="form-group col-md-12">
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Starting Date</label>
                            <input type="date" required name="StartDate" onchange="CheckStartDateEndDate()" id="AddStartDate" class="form-control" value="" min="@Model.StartDate.Value.ToString("yyyy-MM-dd")" max="@Model.EndDate.Value.ToString("yyyy-MM-dd")" />
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Starting Time</label>
                            <input id="sdtimepicker1" type="text" onchange="checktimeperiod()" name="Starttime" class="form-control input-small">

                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red"></span>Task Start Date</label>
                            <h5>@Model.StartDate.Value.ToString("MM-dd-yyyy")</h5>
                        </div>


                    </div>
                    <div class="form-group col-md-12">

                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Ending Date</label>
                            <input type="date" required name="EndDate" onchange="CheckStartDateEndDate()" id="AddEndDate" class="form-control" value="" min="@Model.StartDate.Value.ToString("yyyy-MM-dd")" max="@Model.EndDate.Value.ToString("yyyy-MM-dd")" />
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Ending Time</label>
                            <input id="edtimepicker1" type="text" onchange="checktimeperiod()" name="Endtime" class="form-control input-small">

                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red"></span>Task End Date</label>
                            <h5>@Model.EndDate.Value.ToString("MM-dd-yyyy")</h5>
                        </div>

                    </div>

                </div>

                <div class="row">
                    <div class="col-md-5 col-md-offset-1">
                        Upload File &nbsp;&nbsp;<span class="small text-danger">(Max 10 MBs)</span>
                        <br />
                        <p class="text-danger" id="errorMessageTodo"></p>
                    </div>
                    <div class="col-md-4">
                        <input type="file" name="file" onchange="ValidateSizeTodo(this)" />
                    </div>
                </div>
                <br />
                <!-- For selecting location in document mnager starts, By Wajeeh -->
                @if (Company.IsDocManager == 1)
                {
                    <div class="row">

                        <div id="customLocPathMainBtn3">
                            <div class="col-md-5 col-md-offset-1">
                                <h6 class="small">Select Document Manager Save Location:</h6>
                            </div>
                            <div class="col-md-4">
                                <button style="margin-bottom:10px;" onclick="selectFolderFromDocM('-1','3')" title="Select custom location in Document Manager" type="button" class="btn btn-sm bg-primary-400">Location</button>
                            </div>
                            <div class="col-md-12">
                                <div style="display:none;" id="customLocPathDiv3" class="form-group col-md-12">
                                    <label class="control-label"><b>Your File will be saved at this path in document manager:</b></label>
                                    <button title="Delete Path" type="button" onclick="removeSelectFolderPath('3')" class="close" aria-hidden="true" style="">×</button>
                                    <input readonly name="customLocPath" id="customLocPath3" class="form-control" type="text" />
                                    <input name="FolderId" id="customLocPathHidden3" class="form-control" type="hidden" />
                                </div>
                            </div>

                        </div>
                    </div>

                }
                <!-- For selecting location in document mnager ends, By Wajeeh -->

                @if (Company.IsDocManager == 1)
                {
                    <hr />
                    <div class="row">
                        <div class="col-md-5 col-md-offset-1">
                            <label class="control-label">Upload file from Document Manager</label>
                        </div>
                        <div class="col-md-4">
                            <input onchange="FileDivTodo()" class="col-md-2" type="checkbox" id="IsDocFileTodo" style="margin-top:10px;" />
                            <span id="spinnerTodo" style="display:none" class="col-md-2"><i class="icon-spinner6 spinner position-left"></i></span>
                        </div>

                        <div id="FileDivTodo" class="form-group col-md-12" hidden>
                            <div class="col-md-4 col-md-offset-1">
                                <label class="control-label ml-10">Doc Manager Files</label>
                            </div>
                            <div class="col-md-6">
                                <select class="select-results-color" id="DocMIDTodo" name="DocMID">
                                    <option value="">Please Choose a File</option>
                                </select>
                            </div>

                        </div>
                    </div>
                    <hr />


                }





                <div class="modal-footer">
                    <p style="color:red" id="ErrorMessage"></p>
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="addtodobtn" class="btn btn-sm  bg-primary-400">Add</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="edittodomodal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" method="post" action="@Url.Action("editToDO", "Task")" enctype="multipart/form-data">
                <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Update To Do</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group col-md-12">
                        <label class="control-label"><span style="color:red">*</span>Name</label>
                        <input type="text" name="name" id="todoName" class="form-control" maxlength="150" required />

                        <input type="hidden" id="ticket_Id" name="ticket_Id" x value="0" />
                    </div>

                    <div class="form-group col-md-12">
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Starting Date</label>
                            <input type="date" id="StartDate" onchange="UpdateCheckStartDateEndDate()" name="StartDate" min="@Model.StartDate.Value.ToString("yyyy-MM-dd")" max="@Model.EndDate.Value.ToString("yyyy-MM-dd")" class="form-control" value="" required />
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Starting Time</label>
                            <input id="sdtimepicker2" type="text" onchange="Updatechecktimeperiod()" name="Starttime" class="form-control input-small">
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red"></span>Task Start Date</label>
                            <h5>@Model.StartDate.Value.ToString("MM-dd-yyyy")</h5>
                        </div>

                    </div>
                    <div class="form-group col-md-12">
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Ending Date</label>
                            <input type="date" id="EndDate" onchange="UpdateCheckStartDateEndDate()" name="EndDate" min="@Model.StartDate.Value.ToString("yyyy-MM-dd")" max="@Model.EndDate.Value.ToString("yyyy-MM-dd")" class="form-control" value="" required />
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red">*</span>Ending Time</label>
                            <input id="edtimepicker2" type="text" onchange="Updatechecktimeperiod()" name="Endtime" class="form-control input-small">
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label"><span style="color:red"></span>Task End Date</label>
                            <h5>@Model.EndDate.Value.ToString("MM-dd-yyyy")</h5>
                        </div>

                    </div>

                </div>
                <div class="row">
                    <div class="col-md-5 col-md-offset-1">
                        Upload File &nbsp;&nbsp;<span class="small text-danger">(Max 10 MBs)</span>
                        <br />
                        <p class="text-danger" id="errorMessageTodoUpd"></p>
                    </div>
                    <div class="col-md-4">
                        <input type="file" name="file" onchange="ValidateSizeTodoUpd(this)" />
                    </div>
                </div>
                <br />
                <!-- For selecting location in document mnager starts, By Wajeeh -->
                @if (Company.IsDocManager == 1)
                {
                    <div class="row">

                        <div id="customLocPathMainBtn4">
                            <div class="col-md-5 col-md-offset-1">
                                <h6 id="customText4" class="small">Select Document Manager Save Location:</h6>
                            </div>
                            <div class="col-md-4">
                                <button style="margin-bottom:10px;" onclick="selectFolderFromDocM('-1','4')" title="Select custom location in Document Manager" type="button" class="btn btn-sm bg-primary-400">Location</button>
                            </div>
                            <div class="col-md-12">
                                <div style="display:none;" id="customLocPathDiv4" class="form-group col-md-12">
                                    <label class="control-label"><b>Your File will be saved at this path in document manager:</b></label>
                                    <button title="Delete Path" type="button" onclick="removeSelectFolderPath('4')" class="close" aria-hidden="true" style="">×</button>
                                    <input readonly name="customLocPath" id="customLocPath4" class="form-control" type="text" />
                                    <input name="FolderId" id="customLocPathHidden4" class="form-control" type="hidden" />
                                </div>
                            </div>

                        </div>

                        @*<div id="customLocPathMainBtn4">
                    <div class="text-center col-md-6">
                        <h6 id="customText4" class="small">Select Custom File Location:</h6>
                        <button style="margin-bottom:10px;" onclick="selectFolderFromDocM('-1','4')" title="Select custom location in Document Manager" type="button" class="btn btn-sm bg-primary-400">Location</button>
                    </div>
                    <div class="col-md-12">
                        <div style="display:none;" id="customLocPathDiv4" class="form-group col-md-12">
                            <label class="control-label"><b>Your File will be saved at this path in document manager:</b></label>
                            <button title="Delete Path" type="button" onclick="removeSelectFolderPath('4')" class="close" aria-hidden="true" style="">×</button>
                            <input readonly name="customLocPath" id="customLocPath4" class="form-control" type="text" />
                            <input name="FolderId" id="customLocPathHidden4" class="form-control" type="hidden" />
                        </div>
                    </div>

                </div>*@
                    </div>
                }
                <!-- For selecting location in document mnager ends, By Wajeeh -->


                @if (Company.IsDocManager == 1)
                {
                    <hr />
                    <div class="row">
                        <div class="col-md-5 col-md-offset-1">
                            <label class="control-label">Upload file from Document Manager</label>
                        </div>
                        <div class="col-md-4">
                            <input onchange="FileDivTodoUpd()" class="col-md-2" type="checkbox" id="IsDocFileTodoUpd" style="margin-top:10px;" />
                            <span id="spinnerTodoUpd" style="display:none" class="col-md-2"><i class="icon-spinner6 spinner position-left"></i></span>
                        </div>
                        <div id="FileDivTodoUpd" class="form-group col-md-12" hidden>
                            <div class="col-md-4 col-md-offset-1">
                                <label class="control-label ml-10">Doc Manager Files</label>

                            </div>
                            <div class="col-md-6">
                                <select class="select-results-color" id="DocMIDTodoUpd" name="DocMID">
                                    <option value="">Please Choose a File</option>
                                </select>
                            </div>

                        </div>
                    </div>
                    <hr />
                }






                <div class="modal-footer">
                    <p style="color:red" id="ErrorMessage2"></p>
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="addtodobtn2" class="btn btn-sm  bg-primary-400">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="completetciketmodal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="modal-body " action="@Url.Action("completeGroupTaskTicket", "Task")" method="post">
                <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                <div class="text-center">
                    <div class="icon-object border-slate-300 text-slate-300"><i class="icon-folder-upload"></i></div>
                    <h5 class="content-group">Are you sure you would like to mark this To Do as complete? <small class="display-block"></small></h5>
                </div>
                <input type="hidden" id="ticketId" name="ticketId" x value="0" />
                <center>
                    <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">No</button>
                    <button type="submit" id="sbbutton1" class="btn btn-sm  btn-danger">Yes</button>


                </center>

            </form>
        </div>
    </div>
</div>

<div id="deletetodomodal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="modal-body " action="@Url.Action("deleteToDO", "Task")" method="post">
                <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                <div class="text-center">
                    <div class="icon-object border-slate-300 text-slate-300"><i class="icon-folder-upload"></i></div>
                    <h5 class="content-group">Are you sure you want to delete this To Do? <small class="display-block"></small></h5>
                </div>
                <input type="hidden" id="ticketid" name="ticket_Id" x value="0" />
                <center>
                    <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">No</button>
                    <button type="submit" id="sbbutton1" class="btn btn-sm  btn-danger">Yes</button>


                </center>

            </form>
        </div>
    </div>
</div>

<div id="deletefrequencytasks" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="modal-body " action="@Url.Action("DeleteAllFrequencyGroupTasks", "Task")" method="post">

                <input type="hidden" name="BackURL" id="BackURL" />
                <input type="hidden" name="Id" value="@Model.Id" />
                <div class="text-center">
                    <div class="icon-object border-slate-300 text-slate-300"><i class="icon-folder-upload"></i></div>
                    <h5 class="content-group">Are you sure you would like to delete all recursive group tasks including this?<small class="display-block"></small></h5>
                </div>
                <center>
                    <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">No</button>
                    <button type="submit" id="sbbutton1" class="btn btn-sm  btn-danger">Yes</button>


                </center>

            </form>
        </div>
    </div>
</div>

<div id="requestModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" method="post" action="@Url.Action("requestUpdate", "Task", new { IsModal=ViewBag.page })">
                <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Request Update</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group col-md-12">
                        <label class="control-label">Days</label>
                        <input type="number" name="RequestedDays" required="required" min="0" class="form-control" />
                        @if (Model.CreatedBy != null)
                        {
                            <input type="hidden" name="createdBy" class="form-control" value=@General_Purpose.EncryptId(Model.CreatedBy.Value) />
                        }
                        else
                        {
                            <input type="hidden" name="createdBy" class="form-control" value="-1" />

                        }
                        <input type="hidden" value="@Model.Id" name="GroupTaskDetails_Id" />
                    </div>



                    <div class="form-group col-md-12">
                        <label class="control-label">Reason</label>
                        <textarea class="form-control" name="Reason"></textarea>
                    </div>




                    <div class="modal-footer">
                        <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn  btn-sm bg-primary-400">Request</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="editComment" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-horizontal" method="post" action="@Url.Action("updateGroupComment", "Task",new { isModal=ViewBag.page})" enctype="multipart/form-data">
                @*<input type="hidden" name="isModal" value="0" />*@
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Edit Comment</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group col-md-12">
                        <label class="control-label">Comment</label>
                        <textarea class="form-control" maxlength="500" id="editText" name="comment"></textarea>
                    </div>
                    <input type="hidden" name="taskId" value="@Model.Id" />
                    <input type="hidden" name="commentId" id="commentId" value="-1" />
                    <input type="hidden" name="isManag" id="isManag" value="-1" />
                    <input type="hidden" name="removeFile" id="removeFile" value="-1" />
                    <div class="form-group col-md-12">
                        <div class="row">
                            <div class="col-md-6">
                                <label class="control-label" id="upLoad">Upload new File &nbsp;&nbsp;<span class="small text-danger">(Max 10 MBs)</span></label>
                                <input type="file" name="File" class="form-control" onchange="ValidateSizeCommentUpd(this)" />
                                <br />
                                <p class="text-danger" id="errorMessageCmtUpd"></p>
                            </div>

                            <!-- For selecting location in document mnager starts, By Wajeeh -->
                            @if (Company.IsDocManager == 1)
                            {
                                <div id="customLocPathMainBtn1">
                                    <div class="text-center col-md-6">
                                        <h6 class="small" id="customText">Select Custom File Location:</h6>
                                        <button style="margin-bottom:15px;" onclick="selectFolderFromDocM('-1','1')" title="Select custom location in Document Manager" type="button" class="btn btn-sm bg-primary-400">Location</button>
                                    </div>

                                    <div class="col-md-12">
                                        <div style="display:none;" id="customLocPathDiv1" class="form-group col-md-12">
                                            <label class="control-label"><b>Your File will be saved at this path in document manager:</b></label>
                                            <button title="Delete Path" type="button" onclick="removeSelectFolderPath('1')" class="close" aria-hidden="true" style="">×</button>
                                            <input readonly name="customLocPath" id="customLocPath1" class="form-control" type="text" />
                                            <input name="FolderId" id="customLocPathHidden1" class="form-control" type="hidden" />
                                        </div>
                                    </div>

                                </div>

                            }
                            <!-- For selecting location in document mnager ends, By Wajeeh -->

                        </div>

                    </div>

                    @if (Company.IsDocManager == 1)
                    {
                        <div class="form-group col-md-12">
                            <label class="control-label col-md-5">Upload file from Document Manager</label>
                            <input onchange="FileDivCmtUpd()" class="col-md-2" type="checkbox" id="IsDocFileCmtUpd" />
                            <span id="spinnerCmtUpd" style="display:none" class="col-md-2"><i class="icon-spinner6 spinner position-left"></i></span>
                        </div>
                        <div id="FileDivCmtUpd" class="form-group col-md-12" hidden>
                            <label class="control-label ml-10">Doc Manager Files</label>
                            <select class="select-results-color" id="DocMIDCmtUpd" name="DocMID">
                                <option value="">Please Choose a File</option>
                            </select>
                        </div>
                    }

                    <button class="btn btn-sm bg-danger" id="removeExistingFile" onclick="changeFileStatus()">Remove Existing File</button>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm  btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="submitUpd" class="btn  btn-sm bg-primary-400">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="deleteComment" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="modal-body " action="@Url.Action("deleteGroupComment", "Task")" method="post">
                <input type="hidden" name="isModal" value="@ViewBag.isModal " />
                <div class="text-center">
                    <div class="icon-object border-slate-300 text-slate-300"><i class="icon-folder-upload"></i></div>
                    <h5 class="content-group">Are you sure you would like to delete the comment?<small class="display-block"></small></h5>
                </div>
                <input type="hidden" name="taskId" value="@Model.Id" />
                <input type="hidden" name="commentId" id="commentId1" value="-1" />
                <input type="hidden" name="isManag" id="isManag1" value="-1" />   <center>
                    <button type="button" data-dismiss="modal" class="btn btn-sm  bg-primary">No</button>
                    <button type="submit" id="sbbutton1" class="btn btn-sm  btn-danger">Yes</button>


                </center>

            </form>
        </div>
    </div>
</div>

<!-- Modal for selecting location in documnet manager, By Wajeeh -->
<!-- Select Folder -->
<div id="moveDirectoryModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content login-form">
            <div class="modal-header bg-primary">
                <button type="button" class="close" data-dismiss="modal">×</button>
                <h6 id="moveTitle" class="modal-title text-center"><strong>Select Folder Location In Document Manager</strong></h6>
            </div>

            <div class="modal-body">
                <div class="breadcrumb-line">
                    <a class="breadcrumb-elements-toggle"><i class="icon-menu-open"></i></a>
                    <ul id="breadCrumbDiv" class="breadcrumb"></ul>

                </div>

                <div class="table-wrapper-scroll-y my-custom-scrollbar">
                    <div style="margin:0;" class="row">

                        <div class="col-lg-12 text-left">
                            <br />
                            <a style="display:none;" id="selectHomeLink"><b><i class="icon-select2"></i> Select Home</b></a>
                            <br />
                            <a id="createNewFolLink"><b><i class="icon-folder-plus2"></i> Create Folder</b></a>

                            <input style="display:none;margin-top:8px;margin-bottom:8px;" id="createNewFolInput" name="Name" type="text" class="form-control" placeholder="Name of Directory">
                            <h6 id="folErr" style="display:none;color:red;"><b>Enter folder name!</b></h6>
                            <h6 id="folGenErr" style="display:none;color:red;"><b></b></h6>
                            <h6 id="folGenMsg" style="display:none;color:green;"><b></b></h6>
                            <button style="display:none;" class="btn btn-sm bg-primary-300" id="createNewFolSubmitBtn"><i class="icon-check2"></i> Create</button>

                            @*<span>
                                    <button style="display:none;" class="btn btn-sm bg-primary-300" id="createNewFolSubmitBtn"><i class="icon-check2"></i></button>
                                    <button onclick="hideContent()" style="display:none;" class="btn btn-sm btn-danger" id="createNewCrossBtn"><i class="icon-cross2"></i></button>
                                </span>*@

                            <input type="hidden" id="createNewFolHidden" />
                        </div>


                    </div>
                    <table id="moveDirectoryTbl" class="table table-hover">
                        <thead>
                            <tr>
                                <th><strong>Folder Name</strong></th>
                                <th style="text-align:center;"><strong>Action</strong></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<br />
<br />
@{
    int divisionId = -1;


}

<!-- Content area -->
<div class="content">
    <!-- Detailed task -->
    <div class="row">
        <div class="col-lg-9">

            @if (ViewBag.request != null)
            {
                <div class="alert alert-success" data-auto-dismiss role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    @ViewBag.request
                    @{
                        ViewBag.request = null;
                    }
                </div>
            }
            @if (ViewBag.requestResponse != null)
            {
                <div class="panel panel-flat" id="requestDiv">
                    <div class="panel-heading mt-5">
                        <center><h3 class="panel-title">Request</h3></center>
                        <div class="heading-elements">
                        </div>
                    </div>

                    <div class="panel-body">
                        <h6 class="text-semibold"> @ViewBag.requestResponse</h6>
                        <a href="#" class="btn btn-sm  bg-primary-400" id="requestButton">Dismiss</a>
                    </div>
                </div>
            }


            @if (ViewBag.extenstionRequest != null)
            {
                <!-- Task overview -->
                <div class="panel panel-flat" id="requestDiv">
                    <div class="panel-heading mt-5">
                        <h5 class="panel-title">Request</h5>
                        <div class="heading-elements">
                        </div>
                    </div>
                    <form method="post" id="requestmethod" action="@Url.Action("groupRequestResponse", "Task")">
                        <div class="panel-body">
                            <input type="hidden" name="rd" value="@ViewBag.erId" />
                            <input type="hidden" name="isModal" value="@ViewBag.isModal" />
                            <input type="hidden" name="gd" value="@General_Purpose.EncryptId(Model.Id)" />
                            <input type="hidden" name="responseid" id="responseid" value="1" />
                            <h6 class="text-semibold"> @ViewBag.extenstionRequest</h6>
                            <a href="#" class="btn btn-sm  bg-primary-400" id="requestButton1" onclick="updateValue(1)">Accept</a>
                            <a href="#" class="btn  btn-sm bg-danger" id="_reject" onclick="updateValue(2)">Reject</a>


                        </div>
                    </form>

                </div>
            }
            <!-- /task overview -->
            <!-- Task overview -->
            <div class="panel panel-flat">
                <div class="panel-heading mt-5">
                    <label class="control-label"><b>Task Name </b> </label> <h5 class="panel-title">@Model.GroupTask.Name</h5>
                    @if (logedinuser.Role == 1 || Model.GroupTask_User.Where(x => x.UserId == logedinuser.Id && x.LeadRole != 3).Count() > 0)
                    {
                        if (Model.CompletionDate == null)
                        {
                            <div class="heading-elements">
                                @{
                                    GroupTaskReminder gtr = new GroupTaskReminderBAL().getGroupTaskRemindersList().Where(c => c.UserID == logedinuser.Id && c.IsSent == 0 && c.GroupTasks_DetailsID == Model.Id).FirstOrDefault();
                                }
                                <ul class="icons-list">
                                    <li class="dropdown">
                                        <a href="#" class="btn btn-sm dropdown-toggle bg-primary-400 text-white" data-toggle="dropdown">Actions <i class="icon-menu7"></i> </a>

                                        <ul class="dropdown-menu dropdown-menu-right">
                                            <li>
                                                <a href="@Url.Action("GroupTaskAnalysis","Analysis",new {gid=General_Purpose.EncryptId(Model.Id) , sid=ViewBag.GrpTskId,isModal=ViewBag.page })" data-toggle="modal">Switch to Analysis Mode</a>
                                            </li>
                                            <li>
                                                <a href="@Url.Action("downloadGroupTaskDetails","ExportReport",new {sId=General_Purpose.EncryptId(Model.Id) })" data-toggle="modal" target="_blank">Export PDF</a>
                                            </li>
                                            @*@if (DateTime.Now > Model.StartDate)
        {*@
                                            <li>
                                                <a href="#" data-target="#statusModal" data-toggle="modal">Update Status </a>
                                            </li>
                                            @*}*@
                                            @if (Model.CreatedBy == logedinuser.Id || logedinuser.Role == 1)
                                            {
                                                <li>  <a href="#" data-target="#requestModal" data-toggle="modal">Update Deadline </a> </li>

                                            }
                                            else
                                            {
                                                GroupTask_User primelead = Model.GroupTask_User.Where(x => x.IsActive == 1 && x.LeadRole == 1).FirstOrDefault();
                                                if (Model.CreatedBy != null)
                                                {
                                                    if (primelead != null)
                                                    {
                                                        if (logedinuser.Id != Model.CreatedBy && logedinuser.Id == primelead.UserId)
                                                        {
                                                            <li><a href="#" data-target="#requestModal" data-toggle="modal">Request Extension</a></li>

                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    if (primelead != null)
                                                    {
                                                        if (logedinuser.Id == primelead.Id)
                                                        {
                                                            <li><a href="#" data-target="#requestModal" data-toggle="modal">Request Extension</a></li>

                                                        }
                                                    }
                                                }


                                            }
                                            @if (Convert.ToDateTime(Model.EndDate).Date >= DateTime.Now.Date)
                                            {


                                                if (gtr == null)
                                                {
                                                    <li>  <a href="#" data-target="#GroupTaskReminder" data-toggle="modal">Set Reminder</a> </li>

                                                }
                                                else
                                                {
                                                    <li>  <a href="#" onclick="UpdateGroupTaskReminder('@gtr.Id')" data-toggle="modal">Update Reminder</a> </li>
                                                    <li>  <a href="#" onclick="offGroupTaskReminder(@gtr.Id)" data-toggle="modal">Set Off Reminder</a> </li>
                                                    <input type="hidden" id="editremindertime" value="@gtr.ReminderTime.Value.ToString("yyyy-MM-dd hh:mm:ss tt")" />


                                                }
                                            }
                                            @if (Company.IsLMS == 1 && Model.CourseId != null)
                                            {
                                                User_Task ut = new User_TaskBL().GetGroupStudyUser_Tasks(Convert.ToInt32(logedinuser.Company)).Where(x => x.GroupTaskDetailId == Model.Id).FirstOrDefault();
                                                if (logedinuser.Id == ut.UserID)
                                                {
                                                    <li>  <a href="#" data-target="#SwitchGStudyLeader" data-toggle="modal">Switch Leader</a> </li>
                                                }
                                            }
                                        </ul>

                                    </li>
                                </ul>






                            </div>

                        }
                    }


                </div>

                <div class="panel-body">
                    <h6 class="text-semibold">Task Description</h6>
                    @if (Model.Notes != null)
                    {
                        <p class="content-group">@Model.Notes</p>
                    }
                    <div class="row container-fluid">


                    </div>
                </div>
            </div>
            <input type="hidden" value="@Model.Id" id="UtaskId2" />
            <input type="hidden" id="Sortvalue" value="@Model.TicketSortBy" />

            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-flat">
                        <div class="panel-heading">
                            <center><h3 class="panel-title"><b>To Do</b></h3></center>
                            <div class="heading-elements">
                                @*@if (((int)Session["Role"] == 1 || (int)Session["Role"] == 2 || (int)Session["Role"] == 4) && ((Model.CreatedBy.HasValue && (int)Session["Id"] == Model.CreatedBy.Value) || Model.GroupTask_User.Where(x => x.IsActive == 1 && x.UserId == (int)Session["Id"]).Count() > 0))*@


                                @if (Model.CompletionDate == null && (logedinuser.Role == 1 || logedinuser.Role == 2 || logedinuser.Role == 4))

                                {
                                    <a href="#" class="btn btn-sm bg-primary-400 text-white" data-target="#todoModal" data-toggle="modal"> Add To Do</a>
                                    @*<a href="#" class="btn btn-sm dropdown-toggle bg-primary-400 text-white" data-toggle="dropdown">Actions <i class="icon-menu7"></i> </a>*@

                                }

                            </div>
                        </div>
                        <div class="panel-body">
                            <div class="tabbable">
                                @{
                                    int activetodos = ViewBag.uncompletedTickets.Count;
                                    int completedtodos = ViewBag.completedTickets.Count;
                                }
                                <ul class="nav nav-tabs nav-tabs-highlight border-grey-400">
                                    <li class="active"><a href="#badges-tab1" data-toggle="tab"><span class="badge badge-warning position-left">@activetodos</span> Active</a></li>
                                    <li><a href="#badges-tab2" data-toggle="tab"><span class="badge badge-success position-left">@completedtodos</span>Inactive </a></li>
                                    <li><a href="#badges-tab3" data-toggle="tab">To Do Chart</a></li>

                                </ul>



                                <div class="tab-content">
                                    <div style="height:265px; overflow:auto" class="tab-pane active table-responsive" id="badges-tab1">
                                        <table id="example" class="table datatable-row-events table-bordered table-striped">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        <div>
                                                            Sr# @*<i id="asc" class="glyphicon glyphicon-chevron-up" onclick="sortTable('asc')"></i>
                                                                <i id="dsc" class="glyphicon glyphicon-chevron-down" onclick="sortTable('dsc')"></i>*@
                                                        </div>
                                                    </th>
                                                    <th>Name</th>
                                                    <th style="display:none">Id</th>
                                                    <th>Start Date</th>
                                                    <th>End Date</th>
                                                    <th>Action</th>

                                                </tr>
                                            </thead>
                                            <tbody>

                                                @{
                                                    int i = 0;
                                                    //List<GroupTask_Ticket> ll = ViewBag.uncompletedTickets;

                                                    //    ll = ll.OrderBy(c => c.Postion).ToList();



                                                    string str = "";

                                                    foreach (GroupTask_Ticket item in ViewBag.uncompletedTickets)
                                                    {

                                                        i++;

                                                        str = "";
                                                        if (item.Name.Contains("qqqqaaaa"))
                                                        {
                                                            str = item.Name.Replace("qqqqaaaa", " ");

                                                        }
                                                        <tr>
                                                            <td>@i</td>



                                                            @if (str != "")
                                                            {
                                                                <td>
                                                                    <div class="col-lg-12">
                                                                        <div class="col-lg-11">
                                                                            <sup>

                                                                                <b>
                                                                                    (Edited)
                                                                                </b>

                                                                            </sup><br />
                                                                            @str
                                                                        </div>
                                                                        <div class="col-lg-1">
                                                                            @if (item.Ticket_File != null)
                                                                            {
                                                                                <form action="@Url.Action("download", "Trainee")">
                                                                                    <input type="hidden" name="filepath" value="@item.Ticket_File" />
                                                                                    <input type="hidden" name="name" value="@item.Ticket_FileName" />
                                                                                    <button type="submit" class="" title="@item.Ticket_FileName"><span class="icon-download"></span></button>
                                                                                </form>
                                                                            }

                                                                        </div>
                                                                    </div>


                                                                </td>
                                                            }
                                                            else
                                                            {
                                                                <td>
                                                                    <div class="col-lg-12">
                                                                        <div class="col-lg-11"> @item.Name</div>
                                                                        <div class="col-lg-1">
                                                                            @if (item.Ticket_File != null)
                                                                            {
                                                                                <form action="@Url.Action("download", "Trainee")">
                                                                                    <input type="hidden" name="filepath" value="@item.Ticket_File" />
                                                                                    <input type="hidden" name="name" value="@item.Ticket_FileName" />
                                                                                    <button type="submit" class="" title="@item.Ticket_FileName"><span class="icon-download"></span></button>
                                                                                </form>
                                                                            }

                                                                        </div>
                                                                    </div>
                                                                </td>
                                                            }


                                                            @{
                                                                int val = item.Id + 643;
                                                            }
                                                            <td style="display:none">@val/G</td>

                                                            <td>@item.StartDate</td>
                                                            <td>@item.EndDate</td>
                                                            <td>
                                                                @if (Model.CompletionDate == null)
                                                                {
                                                                    if (item.StartDate != null)
                                                                    {
                                                                        <input type="hidden" id="editname_@item.Id" value="@item.Name" />
                                                                        <input type="hidden" id="editsdate_@item.Id" value="@item.StartDate.Value.ToString("yyyy-MM-dd")" />
                                                                        <input type="hidden" id="editstime_@item.Id" value="@item.StartDate" />
                                                                        <input type="hidden" id="editedate_@item.Id" value="@item.EndDate.Value.ToString("yyyy-MM-dd")" />
                                                                        <input type="hidden" id="editetime_@item.Id" value="@item.EndDate" />

                                                                        <button class="" title="Edit To Do" onclick="editToDo('@item.Id','@item.IsDocMFile')"> Edit</button>

                                                                    }
                                                                    else
                                                                    {
                                                                        <input type="hidden" id="editname_@item.Id" value="@item.Name" />
                                                                        <input type="hidden" id="editsdate_@item.Id" value="@item.StartDate" />
                                                                        <input type="hidden" id="editstime_@item.Id" value="@item.StartDate" />
                                                                        <input type="hidden" id="editedate_@item.Id" value="@item.EndDate" />
                                                                        <input type="hidden" id="editetime_@item.Id" value="@item.EndDate" />

                                                                        <button class="" title="Edit To Do" onclick="editToDo('@item.Id','@item.IsDocMFile')"> Edit</button>

                                                                    }
                                                                    @*<button class="" onclick="editToDo('@item.Id', '@item.Name')"> Edit</button>*@
                                                                    <button class="" title="Delete To Do" onclick="deleteToDo('@item.Id')"> Delete</button>
                                                                    <button class="" title="Close To Do" onclick="updatToDo(@item.Id)"> Close</button>
                                                                }
                                                            </td>
                                                        </tr>
                                                    }
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="tab-pane table-responsive" id="badges-tab2">
                                        <table class="table table-bordered table-striped">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Name</th>

                                                    <th>Time</th>
                                                </tr>
                                            </thead>
                                            <tbody>

                                                @{
                                                    int j = 0;
                                                    string str2 = "";
                                                    foreach (GroupTask_Ticket item in ViewBag.completedTickets)
                                                    {
                                                        j++;
                                                        str2 = "";
                                                        if (item.Name.Contains("qqqqaaaa"))
                                                        {
                                                            str2 = item.Name.Replace("qqqqaaaa", " ");

                                                        }
                                                        <tr>
                                                            <td>@j</td>



                                                            @if (str2 != "")
                                                            {
                                                                <td>

                                                                    <div class="col-lg-12">
                                                                        <div class="col-lg-11">
                                                                            <sup>

                                                                                <b>
                                                                                    (Edited)
                                                                                </b>

                                                                            </sup><br />
                                                                            @str2
                                                                        </div>
                                                                        <div class="col-lg-1">
                                                                            @if (item.Ticket_File != null)
                                                                            {
                                                                                <form action="@Url.Action("download", "Trainee")">
                                                                                    <input type="hidden" name="filepath" value="@item.Ticket_File" />
                                                                                    <input type="hidden" name="name" value="@item.Ticket_FileName" />
                                                                                    <button type="submit" class="" title="@item.Ticket_FileName"><span class="icon-download"></span></button>
                                                                                </form>
                                                                            }

                                                                        </div>
                                                                    </div>

                                                                </td>
                                                            }
                                                            else
                                                            {
                                                                <td>
                                                                    <div class="col-lg-12">
                                                                        <div class="col-lg-11"> @item.Name</div>
                                                                        <div class="col-lg-1">
                                                                            @if (item.Ticket_File != null)
                                                                            {
                                                                                <form action="@Url.Action("download", "Trainee")">
                                                                                    <input type="hidden" name="filepath" value="@item.Ticket_File" />
                                                                                    <input type="hidden" name="name" value="@item.Ticket_FileName" />
                                                                                    <button type="submit" class="" title="@item.Ticket_FileName"><span class="icon-download"></span></button>
                                                                                </form>
                                                                            }

                                                                        </div>
                                                                    </div>
                                                                </td>
                                                            }


                                                            <td>@item.CompletionDatetime.Value.ToString()</td>

                                                        </tr>
                                                    }
                                                }

                                            </tbody>
                                        </table>
                                    </div>


                                    <div style="height:400px;" class="tab-pane table-responsive text-center" id="badges-tab3">

                                        <div class="row">
                                            <div class="col-md-2"></div>
                                            <div id="canvas-holder" class="col-lg-8">
                                                <canvas id="chart-area"></canvas>
                                                <h3>Active &amp; Completed To Dos</h3>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>




            </div>

            <!-- Comments -->
            <div class="panel panel-flat">
                <div class="panel-heading">
                    <h5 class="panel-title text-semiold"><i class="icon-bubbles4 position-left"></i> Comments</h5>
                </div>
                <div class="panel-body">
                    @*<ul id="commentsscroll" style="height:500px; overflow:auto" class="media-list content-group-lg stack-media-on-mobile">*@
                    <ul id="commentsscroll" class="media-list content-group-lg stack-media-on-mobile">
                        @{int flag = 0;}
                        @foreach (TaskCommentDTO item in ViewBag.comments)
                        {

                            if (flag == 0)
                            {
                                <input type="hidden" value="@item.Id" id="dropupID" />
                                <div id="diva"></div>
                                flag++;
                            }

                            <li class="media filediv" id="f_@item.Id">

                                <div class="media-left">
                                    @if (item.Image != null && item.Image != "")
                                    {
                                        string URL = General_Purpose.RefreshImageSignature((int)item.userId);
                                        <img src="@URL" onclick="openUserProfileModal('@item.userId')" class="img-circle img-sm" alt="">


                                    }
                                    else
                                    {
                                        <img src="~/Content/Images/ig.png" onclick="openUserProfileModal('@item.userId')" class="img-circle img-sm" alt="">
                                    }

                                </div>
                                <div class="media-body">
                                    <div class="media-heading">



                                        <a href="#" id="commentvalue" class="text-semibold">
                                            @item.Name
                                            <sup><b>@item.ROLE</b></sup>
                                        </a>
                                        <span class="media-annotation dotted">@item.CommentTime</span>



                                    </div>

                                    @if (item.Comment == "" || item.Comment == null)
                                    {
                                        if (item.File != null)
                                        {

                                            <p>File Attached: @item.File</p>

                                        }

                                    }
                                    else
                                    {
                                        int len = item.Comment.Length;
                                        if (len > 100)
                                        {
                                            <p>@item.Comment.Substring(0, 100)<span id="@item.Id+dots">...</span><span style="display:none" id="@item.Id+more">@item.Comment.Substring(100, len - 101)</span>&nbsp;&nbsp; <a onclick="myFunction(@item.Id)" id="@item.Id+myBtn">Read more</a></p>

                                        }
                                        else
                                        {
                                            <p>@item.Comment</p>
                                        }
                                    }

                                    <ul class="list-inline list-inline-separate text-size-small">

                                        <li>
                                            <ul class="icons-list">
                                                <li id="li_@item.Id" class="dropdown dropup text-muted">
                                                    <a href="#" class="dropdown-toggle text-bold" onclick="AdjustIconlist(@item.Id)" data-toggle="dropdown" aria-expanded="false">Actions <span class="caret"></span></a>
                                                    <ul class="dropdown-menu dropdown-menu-right">
                                                        @if (item.File != null)
                                                        {
                                                            <li><a href="@Url.Action("download","Trainee", new {filePath=item.FilePath,name=item.File })"> <i class="icon-download"></i>Download File</a></li>


                                                        }
                                                        else
                                                        {
                                                            <li><a> <i class="icon-download"></i>No File</a></li>

                                                        }
                                                        @if (item.userId == logedinuser.Id)
                                                        {
                                                            <li><a onclick="editComment('@item.Comment','@item.Id','@item.isManager','@item.File','@item.IsDocMFile')"><i class="icon-sync"></i> Update Comment</a></li>
                                                            <li class="divider"></li>
                                                            <li><a onclick="deleteComment('@item.Id','@item.isManager')"><i class="icon-cross3"></i>Delete</a></li>
                                                        }
                                                        else if (logedinuser.Role == 1)
                                                        {
                                                            <li><a onclick="deleteComment('@item.Id','@item.isManager')"><i class="icon-cross3"></i>Delete</a></li>

                                                        }
                                                        @*<li><a onclick="showreply()"> <i class="icon-reply"></i>Reply</a></li>*@
                                                        <li><a onclick="showreply(@item.Id)"><i class="icon-reply"></i>Reply</a></li>

                                                    </ul>
                                                </li>
                                                <li>
                                                    @if (item.obj.Count() > 0)
                                                    {
                                                        <a onclick="commentreplies(@item.Id)" class="" data-toggle="dropdown" aria-expanded="false">(@item.obj.Count()) Replies <span class="caret"></span></a>

                                                    }
                                                    <input type="hidden" value="@ViewBag.viewrepliesId" id="viewrepliesId" />
                                                    <input type="hidden" value="@ViewBag.replyId" id="replyId" />
                                                </li>
                                            </ul>
                                    </ul>



                                </div>


                            </li>

                            if (item.obj.Count() > 0)
                            {

                                @*<div style="margin-left:150px; " class="rreply scroll" id="@item.Id">
                                    <div style="height:250px; overflow:auto">*@
                                <div style="margin-left:150px; margin-bottom: 30rem;" class="rreply scroll" id="@item.Id">
                                    <div>

                                        @{int flag1 = 0;}
                                        @foreach (TaskCommentDTO2 item2 in item.obj.OrderBy(x => x.Id))
                                        {

                                            if (flag1 == 0)
                                            {
                                                <input type="hidden" value="@item2.Id" id="RepliesdropupID_@item2.Id" />
                                                <div id="divrep_@item2.Id"></div>
                                                flag1++;
                                            }

                                            <li class="media filediv">

                                                <div class="media-left">
                                                    @if (item2.Image != null && item2.Image != "")
                                                    {
                                                        string URL = General_Purpose.RefreshImageSignature((int)item2.userId);
                                                        <img src="@URL" onclick="openUserProfileModal('@item2.userId')" class="img-circle img-sm" alt="">


                                                    }
                                                    else
                                                    {
                                                        <img src="~/Content/Images/ig.png" onclick="openUserProfileModal('@item2.userId')" class="img-circle img-sm" alt="">
                                                    }

                                                </div>
                                                <div class="media-body">
                                                    <div class="media-heading">
                                                        <a href="#" class="text-semibold">
                                                            @item2.Name
                                                            <sup><b>@item2.ROLE</b></sup>
                                                        </a>
                                                        <span class="media-annotation dotted">@item2.CommentTime</span>
                                                    </div>
                                                    @if (item2.Comment == "" || item2.Comment == null)
                                                    {
                                                        <p class="text-semibold">File Attached: @item2.File</p>
                                                    }
                                                    else
                                                    {
                                                        int len2 = item2.Comment.Length;
                                                        if (len2 > 100)
                                                        {
                                                            <p>@item2.Comment.Substring(0, 100)<span id="@item2.Id+dots">...</span><span style="display:none" id="@item2.Id+more">@item2.Comment.Substring(100, len2 - 101)</span>&nbsp;&nbsp; <a onclick="myFunction(@item2.Id)" id="@item2.Id+myBtn">Read more</a></p>

                                                        }
                                                        else
                                                        {
                                                            <p>@item2.Comment</p>
                                                        }

                                                    }



                                                    <ul class="list-inline list-inline-separate text-size-small">

                                                        <li>
                                                            <ul class="icons-list ">
                                                                <li class="dropdown dropup text-muted" id="@item2.Id">
                                                                    <a href="#" class="dropdown-toggle text-bold" data-toggle="dropdown" onclick="AdjustRepliesIconlist(@item2.Id)" aria-expanded="false">Actions <span class="caret"></span></a>
                                                                    <ul class="dropdown-menu dropdown-menu-right text-size-small">
                                                                        @if (item2.File != null)
                                                                        {
                                                                            <li><a href="@Url.Action("download", "Trainee", new { filePath = item2.FilePath, name = item2.File })"> <i class="icon-download"></i>Download File</a></li>


                                                                        }
                                                                        else
                                                                        {
                                                                            <li><a> <i class="icon-download"></i>No File</a></li>

                                                                        }
                                                                        @if (item2.userId == logedinuser.Id)
                                                                        {
                                                                            <li><a onclick="editComment('@item2.Comment','@item2.Id','@item2.isManager','@item2.File','@item2.IsDocMFile')"><i class="icon-sync"></i> Update Comment</a></li>
                                                                            <li class="divider"></li>
                                                                            <li><a onclick="deleteComment('@item2.Id','@item2.isManager')"><i class="icon-cross3"></i>Delete</a></li>
                                                                        }
                                                                        else if (logedinuser.Role == 1)
                                                                        {
                                                                            <li><a onclick="deleteComment('@item2.Id','@item2.isManager')"><i class="icon-cross3"></i>Delete</a></li>

                                                                        }



                                                                    </ul>
                                                                </li>
                                                            </ul>


                                                    </ul>
                                                </div>

                                            </li>



                                        }

                                    </div>
                                    @if (Model.GroupTask_User.Where(x => x.UserId == logedinuser.Id).ToList().Count > 0 || logedinuser.Role == 1)
                                    {

                                        <form action="@Url.Action("addGroupComment", "Task",new {isModal=ViewBag.page, repcomntid=item.Id})" method="post" enctype="multipart/form-data">
                                            <h6 class="text-semibold"><i class="icon-pencil7 position-left"></i> Your Reply</h6>


                                            <div class="content-group">
                                                <div class="col-md-12">

                                                    <textarea rows="4" class="form-control" onkeyup="ValidateCommentText(this)" maxlength="500" required name="comment"></textarea><br />
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            @*<input type="file" name="file" />*@
                                                            Upload File &nbsp;&nbsp;<span class="small text-danger">(Max 10 MBs)</span>
                                                            <input type="file" name="file" onchange="ValidateSizeCommentReply(this)" />
                                                            <br />
                                                            <p class="text-danger" id="errorMessageCmtReply"></p>
                                                        </div>

                                                        <!-- For selecting location in document mnager starts, By Wajeeh -->
                                                        @if (Company.IsDocManager == 1)
                                                        {
                                                            string mainDiv = "customLocPathMainBtn" + item.Id;


                                                            <div id="@mainDiv">

                                                                <div class="col-md-6">
                                                                    <h6 class="small">Select Custom File Location:</h6>
                                                                    <button style="margin-bottom:15px;" onclick="selectFolderFromDocM('-1','45',@item.Id)" title="Select custom location in Document Manager" type="button" class="btn btn-sm bg-primary-400">Location</button>
                                                                </div>

                                                                @{
                                                                    string div = "customLocPathDiv" + item.Id.ToString();
                                                                    string customInputDiv = "customLocPath" + item.Id.ToString();
                                                                    string customInputHidden = "customLocPathHidden" + item.Id.ToString();
                                                                }

                                                                <div class="col-md-12">
                                                                    <div style="display:none;" id="@div" class="form-group col-md-12">
                                                                        <label class="control-label"><b>Your File will be saved at this path in document manager:</b></label>
                                                                        <button title="Delete Path" type="button" onclick="removeSelectFolderPath('45',@item.Id)" class="close" aria-hidden="true" style="">×</button>
                                                                        <input readonly name="customLocPath" id="@customInputDiv" class="form-control" type="text" />
                                                                        <input name="FolderId" id="@customInputHidden" class="form-control" type="hidden" />
                                                                    </div>
                                                                </div>

                                                            </div>

                                                        }
                                                        <!-- For selecting location in document mnager ends, By Wajeeh -->

                                                    </div>


                                                </div>

                                                @if (Company.IsDocManager == 1)
                                                {
                                                    string checkBox = "IsDocFileCmtRply" + item.Id;
                                                    string spin = "spinnerCmtRply" + item.Id;
                                                    string ggg = "FileDivCmtRply" + item.Id;

                                                    <div class="col-md-12">
                                                        <label class="control-label col-md-5" style="margin-left:-10px;">Upload file from Document Manager</label>
                                                        <input onchange="FileDivCmtRply(@item.Id)" class="col-md-2" type="checkbox" id="@checkBox" />
                                                        <span id="@spin" style="display:none" class="col-md-2"><i class="icon-spinner6 spinner position-left"></i></span>
                                                    </div>
                                                    <div style="z-index:11" id="@ggg" class="col-md-12" hidden>
                                                        <label class="control-label">Doc Manager Files</label>
                                                        <select class="select-results-color" id="DocMIDCmtRply" name="DocMID">
                                                            <option value="">Please Choose a File</option>
                                                        </select>
                                                        <br />
                                                        <br />
                                                        <br />
                                                        <br />
                                                    </div>
                                                }
                                                <div class="col-md-12">

                                                    <button style="margin-top:-30px; margin-right:10px; z-index:11;" id="submitReply" type="submit" class="btn  btn-sm  bg-primary-400 text-right pull-right"><i class="glyphicon glyphicon-send"></i> Send</button>

                                                </div>

                                            </div>

                                            @*<input type="hidden" name="taskId" value="@HttpUtility.UrlEncode(General_Purpose.Encrypt(Model.Id))" />*@
                                            <input type="hidden" name="taskId" value="@ViewBag.taskId" />
                                            <input type="hidden" name="gtd" value="@Model.Id" />




                                        </form>

                                    }
                                    <br />

                                </div>


                            }

                        }

                    </ul>

                    @{

                        if (Model.GroupTask_User.Where(x => x.UserId == logedinuser.Id).ToList().Count > 0 || logedinuser.Role == 1)
                        {
                            if (Model.CompletionDate == null)
                            {
                                <form action="@Url.Action("addGroupComment", "Task",new {isModal=ViewBag.page })" method="post" enctype="multipart/form-data">
                                    <h6 id="yourcomment" class="text-semibold"><i class="icon-pencil7 position-left"></i> Your comment</h6>
                                    <input type="hidden" name="repcomntid" id="repcomntid" />

                                    <div class="content-group">
                                        <div class="col-md-12">
                                            @*<textarea style="opacity:0.5" rows="3" id="grpreplycomment" readonly  class="form-control" name="comment">hello world</textarea><br />*@
                                            <button type="button" id="cancelreplybtn" onclick="cancelreply()" class="close" aria-hidden="true">&times;</button>
                                            <br />

                                            <textarea id="replycomment" style="opacity:0.5" rows="3" readonly class="form-control" maxlength="504" name="replycomment"></textarea><br />
                                            <button type="button" style="font-size:small" disabled id="charCounter" class="close " aria-hidden="true">500</button>

                                            <textarea rows="5" id="grpcomment" onkeyup="btncomment(this)" maxlength="500" class="form-control" name="comment"></textarea><br />
                                        </div>
                                        <div class="col-md-12">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    Upload File &nbsp;&nbsp;<span class="small text-danger">(Max 10 MBs)</span>
                                                    <input type="file" id="grpfile" onchange="btnfile(this)" name="file" class="form-control" />
                                                    <br />
                                                    <p class="text-danger" id="errorMessageCmt"></p>
                                                </div>

                                                <!-- For selecting location in document mnager starts, By Wajeeh -->
                                                @if (Company.IsDocManager == 1)
                                                {
                                                    <div id="customLocPathMainBtn">
                                                        <div class="col-md-9">
                                                            <h6>Select Custom File Location:</h6>
                                                            <button style="margin-bottom:25px;" onclick="selectFolderFromDocM('-1','0')" title="Select custom location in Document Manager" type="button" class="btn btn-sm bg-primary-400">Location</button>
                                                        </div>

                                                        <div style="display:none;" id="customLocPathDiv" class="form-group col-md-12">
                                                            <label class="control-label"><b>Your File will be saved at this path in document manager:</b></label>
                                                            <button title="Delete Path" type="button" onclick="removeSelectFolderPath('0')" class="close" aria-hidden="true" style="">×</button>
                                                            <input readonly name="customLocPath" id="customLocPath" class="form-control" type="text" />
                                                            <input name="FolderId" id="customLocPathHidden" class="form-control" type="hidden" />
                                                        </div>
                                                    </div>

                                                }
                                                <!-- For selecting location in document mnager ends, By Wajeeh -->

                                            </div>

                                        </div>

                                        @if (Company.IsDocManager == 1)
                                        {
                                            <div class="form-group col-md-12">
                                                <label class="control-label col-md-5">Upload file from Document Manager</label>
                                                <input onchange="FileDivCmt()" class="col-md-2" type="checkbox" id="IsDocFileCmt" />
                                                <span id="spinnerCmt" style="display:none" class="col-md-2"><i class="icon-spinner6 spinner position-left"></i></span>
                                            </div>
                                            <div id="FileDivCmt" class="form-group col-md-12" hidden>
                                                <label class="control-label ml-10">Doc Manager Files</label>
                                                <select class="select-results-color" id="DocMIDCmt" name="DocMID">
                                                    <option value="">Please Choose a File</option>
                                                </select>
                                            </div>
                                        }
                                    </div>
                                    <input type="hidden" name="taskId" value="@ViewBag.taskId" />
                                    <input type="hidden" name="gtd" value="@Model.Id" />
                                    <div class="text-right">

                                        <button type="submit" id="Submit" class="btn btn-sm bg-primary-400"><i class="glyphicon glyphicon-send"></i> Add comment</button>
                                    </div>
                                </form>
                            }
                        }
                    }
                </div>
            </div>
            <!-- /comments -->
        </div>

        @{
            DateTime d = (DateTime)Model.EndDate;
            //d = d.AddDays(-1);
        }
    <div class="col-lg-3">
        <!-- Timer -->
        <div class="panel panel-flat">
            <div class="panel-heading">
                <h7 class="panel-title"><i class="icon-watch position-left"></i> Task Timer</h7>
                <div class="heading-elements">
                    <ul class="icons-list">
                        <li><a data-action="collapse"></a></li>

                    </ul>
                </div>
            </div>
            <div class="panel-body">
                @if (Model.CompletionDate == null)
                {
                    if (d < DateTime.Now)
                    {
                        <ul class="timer mb-10">
                            <li id="expire" class="text-danger">
                                LATE
                            </li>
                        </ul>
                        <input type="hidden" value="1" id="late" />
                    }
                    else if (Model.StartDate < DateTime.Now)
                    {<input type="hidden" value="2" id="late" />
                        <ul class="timer-weekdays mb-10">
                            @{
                                var day = d.DayOfWeek.ToString();
                            }
                            @if (day == "Friday")
                            {
                                <li class="active"><a href="#" class="label label-danger">@d.DayOfWeek</a></li>
                            }
                            else
                            {
                                <li><a href="#" class="label label-default">Friday</a></li>

                            }
                            @if (day == "Saturday")
                            {
                                <li class="active"><a href="#" class="label label-danger">@d.DayOfWeek</a></li>
                            }
                            else
                            {
                                <li><a href="#" class="label label-default">Saturday</a></li>

                            }
                            @if (day == "Sunday")
                            {
                                <li class="active"><a href="#" class="label label-danger">@d.DayOfWeek</a></li>
                            }
                            else
                            {
                                <li><a href="#" class="label label-default">Sunday</a></li>

                            }
                            @if (day == "Monday")
                            {
                                <li class="active"><a href="#" class="label label-danger">@d.DayOfWeek</a></li>
                            }
                            else
                            {
                                <li><a href="#" class="label label-default">Monday</a></li>

                            }
                            @if (day == "Tuesday")
                            {
                                <li class="active"><a href="#" class="label label-danger">@d.DayOfWeek</a></li>
                            }
                            else
                            {
                                <li><a href="#" class="label label-default">Tuesday</a></li>

                            }
                            @if (day == "Wednesday")
                            {
                                <li class="active"><a href="#" class="label label-danger">@d.DayOfWeek</a></li>
                            }
                            else
                            {
                                <li><a href="#" class="label label-default">Wednesday</a></li>

                            }
                            @if (d.DayOfWeek.ToString() == "Thursday")
                            {
                                <li class="active"><a href="#" class="label label-danger">@d.DayOfWeek</a></li>
                            }
                            else
                            {
                                <li><a href="#" class="label label-default">Thursday</a></li>

                            }
                        </ul>
                        <hr />
                        <ul class="timer mb-10">

                            <li id="d">

                            </li>
                            <li id="h">

                            </li>
                            <li id="m">

                            </li>
                            <li id="s">

                            </li>

                        </ul>
                    }
                    else if (Model.StartDate > DateTime.Now)
                    {
                        <input type="hidden" value="3" id="late" />


                        <ul class="timer mb-10">
                            <li id="expire" class="text-success">
                                Not Started
                            </li>
                        </ul>
                    }
                }


                else
                {
                    <input type="hidden" value="3" id="late" />


                    <ul class="timer mb-10">
                        <li id="expire" class="text-success">
                            <h5>Completed</h5>
                        </li>
                    </ul>
                    if ((logedinuser.Role == 2 || logedinuser.Role == 4 || logedinuser.Role == 1))
                    {
                        <center>


                            <a href="#" data-target="#statusModal" data-toggle="modal" class="btn btn-sm bg-primary-400 text-bold">Reopen Task</a>
                        </center>
                    }

                }
                <div id="clock"></div>
            </div>
        </div>



        <!-- Group STudy Attached Course -->
        @if (Company.IsLMS == 1 && Model.CourseId != null)
        {
            User_Task ut = new User_TaskBL().GetGroupStudyUser_Tasks(Company.Id).Where(x => x.GroupTaskDetailId == Model.Id).FirstOrDefault();
            cou = new Course_UserTaskBL().getCourse_UserTaskList().Where(x => x.CourseID == Model.CourseId && x.User_TaskID == ut.Id).FirstOrDefault();

            if (ut.UserID == logedinuser.Id)
            {
                Course course = new CourseBL().getCourseById((int)Model.CourseId);
                string CourseEncryptedId = General_Purpose.EncryptId(course.Id);
                string CuserTaskEncryptedId = General_Purpose.EncryptId(cou.Id);
                <div class="panel panel-flat">
                    <div class="panel-heading">
                        <h7 class="panel-title"><i class="icon-list position-left"></i> Attached Course</h7>
                        <div class="heading-elements">
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="col-lg-12">
                            <div class="col-lg-6">
                                @course.Name
                            </div>

                            <div class="col-lg-6">
                                @if (course.IsScorm == 1)
                                {

                                    string url = HttpContext.Current.Request.Url.AbsoluteUri;
                                    ScormCloud.Configuration = new RusticiSoftware.HostedEngine.Client.Configuration(
"https://cloud.scorm.com/EngineWebServices",
ProjectVaraiables.ScormAppId,
ProjectVaraiables.ScormSecretKey,
ProjectVaraiables.ScormOrigin);
                                    if (cou.CourseGroupStudyId != 0)
                                    {
                                        if (cou.IsLead == 1)
                                        {

                                            <a href="@ScormCloud.RegistrationService.GetLaunchUrl(cou.Id.ToString(),HttpContext.Current.Request.Url.AbsoluteUri)"> View Course </a>

                                        }
                                        else
                                        {
                                            <a title="Only Group lead can attempt the Course"> View Course </a>
                                        }
                                    }
                                    else
                                    {
                                        <a href="@ScormCloud.RegistrationService.GetLaunchUrl(cou.Id.ToString(),HttpContext.Current.Request.Url.AbsoluteUri)"> View Course </a>

                                    }

                                }
                                else
                                {
                                    if (cou.CourseGroupStudyId != 0)
                                    {
                                        if (cou.IsLead == 1)
                                        {
                                            <a href="@ProjectVaraiables.LMS_URL/Course/CourseDetails?v=@CourseEncryptedId&CuserTask=@CuserTaskEncryptedId"> View Course </a>

                                        }
                                        else
                                        {
                                            <a title="Only Group lead can attempt the Course">View Course</a>
                                        }
                                    }
                                    else
                                    {
                                        <a href="@ProjectVaraiables.LMS_URL/Course/CourseDetails?v=@CourseEncryptedId&CuserTask=@CuserTaskEncryptedId"> View Course </a>

                                    }


                                }

                            </div>
                        </div>
                    </div>
                </div>
            }


        }
        <!-- /timer -->
        @if (logedinuser.Role == 1 || logedinuser.Role == 2 || logedinuser.Role == 3)
        {
            <div class="panel panel-flat">
                <div class="panel-heading">
                    <h7 class="panel-title"><i class="icon-files-empty position-left"></i> Frequency Tasks</h7>
                    <div class="heading-elements">
                        <ul class="icons-list">
                            @*<li><a data-action="collapse"></a></li>*@
                            @{
                                GroupTasks_Details uss = new GroupTasks_DetailsBL().getGroupTasks_DetailssList().Where(x => x.ParentID == Model.Id).FirstOrDefault();
                            }


                            @if (Model.RepeatTime != null)
                            {
                                if (logedinuser.Id == Model.CreatedBy || logedinuser.Role == 1)
                                {
                                    if (Model.CourseId == null)
                                    {
                                        <li class="col-lg-2"><a data-target="#increaseFreqTask" data-toggle="modal"> <i class="icon-add"></i></a></li>
                                        <li class="col-lg-2"> <a onclick="deleteall()" title="Delete all Rescursive group tasks including this"><i class="icon-trash-alt"></i></a></li>
                                    }


                                }

                            }





                        </ul>
                    </div>
                </div>
                <div class="panel-body" style="max-height:295px; overflow:auto">
                    @{ GroupTasks_Details us = new GroupTasks_DetailsBL().getAllGroupTasks_DetailssList().Where(x => x.ParentID == Model.Id).FirstOrDefault(); }
                    @if ((logedinuser.Role == 1 || logedinuser.Role == 2 || logedinuser.Role == 4) && Model.ParentID != null)
                    {
                        GroupTasks_Details u = new GroupTasks_DetailsBL().getGroupTasks_DetailssById((int)Model.ParentID);
                        List<GroupTasks_Details> list = new GroupTasks_DetailsBL().getGroupTasks_DetailssList().Where(c => c.IsActive == 1 && c.ParentID == u.Id).ToList();
                        list.Insert(0, u);
                        <h5 style="margin-left:48px">Start Dates</h5>

                        foreach (GroupTasks_Details x in list)
                        {
                            if (x.Id == Model.Id)
                            {
                                <div id="@x.Id" class="col-lg-12 frehover">

                                    <div class="col-lg-10">
                                        @*<div class="col-lg-4"><b>Start Date:</b></div>*@
                                        <div class="col-lg-12"><b>@x.StartDate</b></div>
                                    </div>


                                </div>
                            }
                            else
                            {
                                if (logedinuser.Role == 1 || logedinuser.Id == Model.CreatedBy || Model.GroupTask_User.Where(c => c.UserId == logedinuser.Id).Count() != 0)
                                {
                                    <div id="@x.Id" class="col-lg-12 frehover">
                                        <div class="col-lg-10">
                                            @*<div class="col-lg-4">Start Date:</div>*@
                                            <div class="col-lg-12"><a target="_blank" title="" href="@Url.Action("grouptaskDetails", "Task", new { v = General_Purpose.EncryptId(x.Id), isModal = "0" })">@x.StartDate</a></div>

                                        </div>

                                        <div class="col-lg-2">
                                            @if (logedinuser.Id == Model.CreatedBy || logedinuser.Role == 1)
                                            {
                                                <button type="button" id="RemoveFreqTask" onclick="deleteFreqUtask('@x.Id')" title="Delete" class="close" aria-hidden="true">&times;</button>

                                            }

                                        </div>
                                    </div>
                                }
                            }

                        }

                    }
                    else
                    {
                        if ((logedinuser.Role == 1 || logedinuser.Role == 2 || logedinuser.Role == 4) && us != null)
                        {
                            GroupTasks_Details u1 = new GroupTasks_DetailsBL().getGroupTasks_DetailssById((int)Model.Id);
                            List<GroupTasks_Details> list1 = new GroupTasks_DetailsBL().getGroupTasks_DetailssList().Where(c => c.IsActive == 1 && c.ParentID == Model.Id).ToList();
                            list1.Insert(0, u1);
                            <h5 style="margin-left:48px">Start Dates</h5>
                            foreach (GroupTasks_Details x in list1)
                            {
                                if (x.Id == Model.Id)
                                {
                                    <div id="@x.Id" class="col-lg-12 frehover">

                                        <div class="col-lg-10">
                                            @*<div class="col-lg-4"><b>Start Date:</b></div>*@
                                            <div class="col-lg-12"><b>@x.StartDate</b></div>
                                        </div>


                                    </div>
                                }
                                else
                                {
                                    if (logedinuser.Role == 1 || logedinuser.Id == Model.CreatedBy || Model.GroupTask_User.Where(c => c.UserId == logedinuser.Id).Count() != 0)
                                    {



                                        <div id="@x.Id" class="col-lg-12 frehover">
                                            <div class="col-lg-10">
                                                @*<div class="col-lg-4">Start Date:</div>*@

                                                <div class="col-lg-12"><a target="_blank" title="" href="@Url.Action("grouptaskDetails", "Task", new { v = General_Purpose.EncryptId(x.Id), isModal = "0" })">@x.StartDate</a></div>



                                            </div>
                                            <div class="col-lg-2">
                                                @if (logedinuser.Id == Model.CreatedBy || logedinuser.Role == 1)
                                                {
                                                    <button type="button" title="Delete" id="RemoveFreqTask" onclick="deleteFreqUtask('@x.Id')" class="close" aria-hidden="true">&times;</button>

                                                }


                                            </div>
                                        </div>
                                    }
                                }

                            }

                        }

                    }
                </div>

            </div>
        }
        <!-- Task details -->
        <div class="panel panel-flat">
            <div class="panel-heading">
                <h7 class="panel-title"><i class="icon-files-empty position-left"></i> Task Details</h7>
                <div class="heading-elements">
                    <ul class="icons-list">
                        <li><a data-action="collapse"></a></li>

                    </ul>
                </div>
            </div>
            <table class="table table-borderless table-xs content-group-sm">

                <tbody>
                    @{
                        GroupTask gt = new GroupTaskBL().getGroupTasksById(Convert.ToInt32(Model.GroupTaskId));
                        int tempuserid = Convert.ToInt32(gt.UserId);

                        User udiv = new UserBL().GetAllUserById(tempuserid);
                        GroupTaskReminder Gtr = Model.GroupTaskReminders.Where(x => x.IsActive == 1 && x.UserID == logedinuser.Id).FirstOrDefault();

                    }
                    @if (Gtr != null)
                    {
                        <tr>
                            <td><i class="icon-reminder position-left"></i>Reminder</td>
                            @if (Gtr.IsSent == 0)
                            {
                                <td class="text-right">@Gtr.ReminderTime</td>

                            }
                            else
                            {
                                <td class="text-right">@Gtr.ReminderTime <span class="success">(Sent)</span></td>

                            }
                        </tr>
                    }
                    <tr>
                        <td><i class="icon-city position-left"></i>Division Name </td>
                        @if (udiv != null)
                        {
                            if (udiv.DivisionId != null)
                            {
                                <td class="text-right">@udiv.Division.Name</td>

                            }
                            else if (udiv.DepartmentId != null)
                            {
                                <td class="text-right">@udiv.Department.Division.Name</td>

                            }
                            else
                            {
                                <td class="text-right"><b style="color:red">Not Defined</b></td>

                            }
                        }
                        else
                        {
                            <td class="text-right"><b style="color:red">Not Defined</b></td>

                        }
                    </tr>
                    <tr>
                        <td><i class="icon-alarm-add position-left"></i> Start Date</td>
                        <td class="text-right">@Model.StartDate.Value.ToString("MM/dd/yyyy")</td>
                    </tr>
                    <tr>
                        @*<td><i class="icon-alarm-add position-left"></i> End Date & Time</td>*@
                        <td><i class="icon-alarm-add position-left"></i> End Date</td>
                        @*<td class="text-right">@Model.EndDate.Value.ToString("MM/dd/yyyy h:mm tt")</td>*@

                        <td class="text-right">@d.ToString("MM/dd/yyyy")</td>
                    </tr>
                    @if (Model.CompletionDate != null)
                    {
                        <tr>
                            <td><i class="icon-alarm-add position-left"></i> Completion Date & Time</td>
                            <td class="text-right">@Model.CompletionDate.Value</td>
                        </tr>

                    }
                    else
                    {
                        <tr>
                            <td><i class="icon-alarm-add position-left"></i> Completion Date & Time</td>
                            <td class="text-right">Not Completed Yet</td>
                        </tr>
                    }
                    <tr>
                        <td><i class="icon-alarm-check position-left"></i> Hours</td>
                        <td class="text-right">@Model.Hours</td>
                    </tr>
                    <tr>
                        <td><i class="icon-circles2 position-left"></i> Priority:</td>
                        <td class="text-right">
                            <div class="btn-group">
                                @if (!Model.Priority.HasValue)
                                {
                                    <span></span>

                                }
                                else if (General_Purpose.getPriorityValue(Model.Priority.Value) == "Medium")
                                {
                                    <span class="mediumPriorityButton">Medium</span>
                                }
                                else if (General_Purpose.getPriorityValue(Model.Priority.Value) == "Low")
                                {
                                    <span class="lowPriorityButton">Low</span> }
                                else
                                {
                                    <span class="highPriorityButton">High</span>}

                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><i class="icon-history position-left"></i> CEU:</td>
                        <td class="text-right">@Model.CEU</td>
                    </tr>

                    <tr>
                        <td><i class="icon-file-check position-left"></i> Status:</td>
                        @if (!Model.Status.HasValue)
                        {
                            <td class="text-right">

                                @General_Purpose.getStatusValue(0)
                            </td>
                        }
                        else
                        {
                            <td class="text-right">

                                @General_Purpose.getStatusValue(Model.Status.Value)
                            </td>
                        }
                    </tr>

                    @if (Model.CourseId != null && Company.IsLMS == 1)
                    {
                        <tr>
                            <td><center><h3><b>Group Study</b></h3></center></td>

                        </tr>
                        int code = cou.Id + 900;
                        <tr>
                            <td class="col-md-8"><i class="icon-bell-plus position-left"></i>Result Status</td>
                            @if (cou.ResultStatus == 1)
                            {

                                <td class="text-right" style="color:forestgreen"><b>PASS</b></td>

                            }
                            else if (cou.ResultStatus == 0)
                            {
                                <td class="text-right" style="color:red"><b>FAIL</b></td>

                            }
                            else
                            {
                                <td class="text-right" style="color:orange"><b>In Process</b></td>

                            }
                        </tr>

                        <tr>
                            <td class="col-md-8"><i class="icon-list-numbered position-left"></i>Course Code</td>

                            <td class="text-right" style="color:black"><b>@code</b></td>
                        </tr>
                    }

                </tbody>
            </table>

        </div>
        <!-- /task details -->
        <!-- Attached files -->
        <div class="panel panel-flat">
            <div class="panel-heading">
                <h7 class="panel-title"><i class="icon-link position-left"></i> Attached Files</h7>
                <div class="heading-elements">
                    <ul class="icons-list">
                        <li><a data-action="collapse"></a></li>

                    </ul>
                </div>
            </div>
            <div class="panel-body" style="height:295px; overflow:auto">
                <ul class="media-list">
                    @foreach (TaskCommentDTO item in ViewBag.Ticketfiles)
                    {
                        if (item.File != null)
                        {
                            <li class="media">
                                <div class="media-left media-middle">
                                    <i class="icon-file-text3 icon-2x text-muted"></i>
                                </div>
                                <div class="media-body">
                                    <a href="@Url.Action("download", "Trainee", new { filePath = item.FilePath, name = item.File })" title="Download" class="media-heading text-semibold">@item.File</a>
                                    <ul class="list-inline list-inline-separate list-inline-condensed text-size-mini text-muted">
                                        <li>Date: @item.CommentTime</li>
                                        <li>Size: @item.FileSize</li>
                                        <li>Added by <a>@item.Name</a></li>
                                    </ul>
                                </div>
                                <div class="media-right media-middle">
                                    <ul class="icons-list">
                                        <li><a href="@Url.Action("download", "Trainee", new { filePath = item.FilePath, name = item.File })" title="Download"><i class="icon-download"></i></a></li>
                                    </ul>
                                </div>
                            </li>


                        }
                    }
                    @foreach (TaskCommentDTO item in ViewBag.comments1)
                    {
                        if (item.File != null)
                        {
                            <li class="media">
                                <div class="media-left media-middle">
                                    <i class="icon-file-text3 icon-2x text-muted"></i>
                                </div>
                                <div class="media-body">
                                    <a href="@Url.Action("download","Trainee", new {filePath=item.FilePath,name=item.File })" class="media-heading text-semibold" title="Download">@item.File</a>
                                    <ul class="list-inline list-inline-separate list-inline-condensed text-size-mini text-muted">
                                        <li>Date: @item.CommentTime</li>
                                        <li>Size: @item.FileSize</li>
                                        <li>Added by <a>@item.Name</a></li>
                                    </ul>
                                </div>
                                <div class="media-right media-middle">
                                    <ul class="icons-list">
                                        <li><a href="@Url.Action("download","Trainee", new {filePath=item.FilePath,name=item.File })" title="Download"><i class="icon-download"></i></a></li>
                                    </ul>
                                </div>
                            </li>
                        }
                        if (item.obj.Count() > 0)
                        {

                            foreach (TaskCommentDTO2 item2 in item.obj)
                            {
                                if (item2.File != null)
                                {
                                    <li class="media">
                                        <div class="media-left media-middle">
                                            <i class="icon-file-text3 icon-2x text-muted"></i>
                                        </div>
                                        <div class="media-body">
                                            <a href="@Url.Action("download", "Trainee", new { filePath = item2.FilePath, name = item2.File })" title="Download" class="media-heading text-semibold">@item2.File</a>
                                            <ul class="list-inline list-inline-separate list-inline-condensed text-size-mini text-muted">
                                                <li>Date: @item.CommentTime</li>
                                                <li>Size: @item2.FileSize</li>
                                                <li>Added by <a>@item2.Name</a></li>
                                            </ul>
                                        </div>
                                        <div class="media-right media-middle">
                                            <ul class="icons-list">
                                                <li><a href="@Url.Action("download", "Trainee", new { filePath = item2.FilePath, name = item2.File })" title="Download"><i class="icon-download"></i></a></li>
                                            </ul>
                                        </div>
                                    </li>
                                }
                            }
                        }
                    }

                </ul>
            </div>
        </div>
        <!-- /attached files -->
        <!-- Assigned users -->
        <div class="panel panel-flat">
            <div class="panel-heading">
                <h7 class="panel-title"><i class="icon-users position-left"></i>  Employees</h7>
                <div class="heading-elements">
                    <ul class="icons-list">
                        @if (Model.CompletionDate == null && logedinuser.Role == 1 || ((logedinuser.Role == 2 || logedinuser.Role == 4) && ((Model.CreatedBy.HasValue && logedinuser.Id == Model.CreatedBy.Value) || logedinuser.Id == Model.GroupTask_User.Where(x => x.IsActive == 1 && x.LeadRole == 1).FirstOrDefault().UserId)))

                        {
                            <li><a data-target="#addmemberModal" data-toggle="modal"> <i class="icon-add"></i></a></li>
                        }

                    </ul>
                </div>
            </div>
            <div class="panel-body" style="height:225px; overflow:auto">
                <ul class="media-list">
                    @{
                        int userProfileId = -1;
                    }
                    @if (Model.CreatedBy != null)
                    {
                        userProfileId = Model.User.Id;

                        <li class="media">
                            <div class="media-left">


                                @if (Model.User.Image == null || Model.User.Image == "")
                                {
                                    <img src="~/Content/Images/ig.png" onclick="openUserProfileModal('@userProfileId')" class="img-circle img-sm" alt="">
                                }
                                else
                                {
                                    string URL = General_Purpose.RefreshImageSignature((int)userProfileId);
                                    <img src="@URL" onclick="openUserProfileModal('@userProfileId')" class="img-sm img-circle" alt="">
                                }

                            </div>
                            <div class="media-body media-middle text-semibold">
                                @Model.User.FirstName  @Model.User.LastName
                                <div class="media-annotation">Assigned the Task</div>
                            </div>


                        </li>
                    }
                    @{
                        GroupTask_User prime;
                        prime = Model.GroupTask_User.Where(x => x.IsActive == 1 && x.LeadRole == 1).FirstOrDefault();
                        if (prime == null)
                        {
                            prime = Model.GroupTask_User.Where(x => x.LeadRole == 1).FirstOrDefault();
                        }
                        int tempID = -1;
                        if (prime != null)
                        {
                            tempID = prime.User.Id;
                        }
                        GroupTask_User second = Model.GroupTask_User.Where(x => x.IsActive == 1 && x.LeadRole == 2 && logedinuser.Id == x.UserId).FirstOrDefault();
                        int label = 0;
                    }
                    @foreach (var item in Model.GroupTask_User.OrderBy(c => c.LeadRole)@*.Where(x => x.IsActive == 1)*@)
{
GroupTask_User p;
p = Model.GroupTask_User.Where(x => x.IsActive == 1 && x.LeadRole == 1).FirstOrDefault();
if (p != null)
{
GroupTask_User p2 = Model.GroupTask_User.Where(x => x.IsActive == 0 && x.LeadRole == 1).FirstOrDefault();
if (p2 != null)
{
if (p2.Id == item.Id)
{
continue;
}
}
}
if (item.LeadRole != 1 && item.IsActive == 0)
{
continue;
}
if (item.LeadRole == 1)
{
if (item.User.IsActive == 1)
{
label = 1;
}
if (item.User.IsActive == 0 && label == 1)
{
continue;
}
    <li class="media">
        <div class="media-left">

            @if (item.User.Image == "" || item.User.Image == null)
            {
                <img src="~/Content/Images/ig.png" onclick="openUserProfileModal('@item.User.Id')" class="img-circle img-sm" alt="">
            }
            else
            {
                string URL = General_Purpose.RefreshImageSignature((int)item.User.Id);
                <img src="@URL" onclick="openUserProfileModal('@item.User.Id')" class="img-sm img-circle" alt="">
            }



        </div>
        <div class="media-body media-middle text-semibold">
            @*@item.User.FirstName @item.User.LastName*@
            @if (logedinuser.Id == item.User.Id)
            {
                if (item.User.IsActive == 0)
                {
                    <span style="color:grey">You <span style="color:red">Deleted</span></span>

                }
                else
                {
                    <span>You</span>

                }

            }
            else
            {
                if (item.User.IsActive == 0)
                {
                    <span style="color:grey">@item.User.FirstName @item.User.LastName <span style="color:red">Deleted</span></span>

                }
                else
                {
                    <span>@item.User.FirstName @item.User.LastName</span>

                }
            }

            @if (Model.CreatedBy == null)
            {
                <div class="media-annotation">Prime Lead & Assigned the Task  </div>
            }
            else
            {
                <div class="media-annotation">Prime Lead</div>

            }
        </div>
        @if (item.User.IsActive == 0 && logedinuser.Role == 1)
        {
            <div class="media-right">

                <a onclick="Function()" title="Add Primary Lead"><i class="icon icon-add"></i></a>
            </div>
        }

    </li>
}
else if (item.LeadRole == 2)
{
    <li id="@item.User.Id" class="media">
        <div class="media-left">

            @if (item.User.Image == "" || item.User.Image == null)
            {
                <img src="~/Content/Images/ig.png" onclick="openUserProfileModal('@item.User.Id')" class="img-circle img-sm" alt="">
            }
            else
            {
                string URL = General_Purpose.RefreshImageSignature((int)item.User.Id);
                <img src="@URL" onclick="openUserProfileModal('@item.User.Id')" class="img-sm img-circle" alt="">
            }

        </div>
        <div class="media-body media-middle text-semibold">
            @if (logedinuser.Id == item.User.Id)
            {
                <span>You</span>

            }
            else
            {
                <span>@item.User.FirstName @item.User.LastName</span>
            }

            <div class="media-annotation">Second Lead</div>
        </div>

        @if (Model.CreatedBy != null)
        {
            if (logedinuser.Id == Model.CreatedBy || logedinuser.Id == tempID || logedinuser.Role == 1)
            {
                if (logedinuser.Id != item.User.Id && Model.CompletionDate == null)
                {
                    <div class="media-right">
                        <button type="button" id="RemoveFreqTask" onclick="removegrpmember(@item.User.Id)" title="Remove" class="close" aria-hidden="true">&times;</button>

                    </div>
                }


            }
        }
        else
        {
            if (logedinuser.Id == tempID || logedinuser.Role == 1)
            {
                if (logedinuser.Id != item.User.Id && Model.CompletionDate == null)
                {
                    <div class="media-right">
                        <button type="button" id="RemoveFreqTask" onclick="removegrpmember(@item.User.Id)" title="Remove" class="close" aria-hidden="true">&times;</button>

                    </div>
                }

            }

        }





    </li>
}
else
{
    <li id="@item.User.Id" class="media">
        <div class="media-left">
            @if (item.User.Image == "" || item.User.Image == null)
            {
                <img src="~/Content/Images/ig.png" onclick="openUserProfileModal('@item.User.Id')" class="img-circle img-sm" alt="">
            }
            else
            {
                string URL = General_Purpose.RefreshImageSignature((int)item.User.Id);
                <img src="@URL" onclick="openUserProfileModal('@item.User.Id')" class="img-sm img-circle" alt="">
            }
        </div>
        <div class="media-body media-middle text-semibold">
            @if (logedinuser.Id == item.User.Id)
            {
                <span>You</span>

            }
            else
            {
                <span>@item.User.FirstName @item.User.LastName</span>
            }

            <div class="media-annotation">Member</div>
        </div>

        @if (Model.CreatedBy != null)
        {
            if (logedinuser.Id == Model.CreatedBy || logedinuser.Id == tempID || second != null || logedinuser.Role == 1)
            {
                if (logedinuser.Id != item.User.Id && Model.CompletionDate == null)
                {
                    <div class="media-right">
                        <button type="button" id="RemoveFreqTask" onclick="removegrpmember(@item.User.Id)" title="Remove" class="close" aria-hidden="true">&times;</button>

                    </div>
                }


            }
        }
        else
        {
            if (logedinuser.Id == tempID || logedinuser.Role == 1 || second != null)
            {
                if (logedinuser.Id != item.User.Id && Model.CompletionDate == null)
                {
                    <div class="media-right">
                        <button type="button" id="RemoveFreqTask" onclick="removegrpmember(@item.User.Id)" title="Remove" class="close" aria-hidden="true">&times;</button>

                    </div>
                }

            }

        }


    </li>
}
}




                </ul>
            </div>
        </div>
        <!-- /assigned users -->

    </div>
    </div>
    <!-- /detailed task -->

    <input type="hidden" name="name" value="@Model.EndDate" id="datep" />


</div>
<!-- /content area -->

<script>
    function Function() {
        var isprime = $("#IsPrime").val();
        if (isprime == 0) {
            $("#SetPrimeLead").modal("show");
        }
    }
    Function();
    function UpdateGroupTaskReminder(id) {

        var x = $("#editremindertime").val();
       //  $("#updatereminder").val(x);
        $("#updategrptaskid").val(id);
        $("#UpdateGroupTaskReminder").modal("show");
         if (x != null && x != "") {
            var starttime = x.split(' ')[1];
            var date = x.split(' ')[0];
              $("#updatereminder").val(date);
            var starttimeAMPM = x.split(' ')[2];
            var st1 = starttime.split(':')[0];
            var st2 = starttime.split(':')[1];
            x = st1 + ":" + st2 + " " + starttimeAMPM;
            $('#edittimepicker7').val(x);
        } else
        {
              $('#edittimepicker7').val();
        }


    }

    function offGroupTaskReminder(id) {


        $("#offgrptaskid").val(id);
        $("#offgrouptaskreminder").modal("show");


    }

     function deleteall() {
        var backurl = $("#backbtn").attr("href");
         $("#BackURL").val(backurl);
       $("#deletefrequencytasks").modal("show");
 //          var origin = window.location.origin;
 //                               var empurl;
 //                           //    var manurl;

 //       empurl = "" + origin + "/Task/DeleteAllFrequencyTasks?Id=" + id + "&BackURL=" + backurl;
 ////empurl = "" + origin + "/ExportReport/ExportEmployeesPdf?list="+ListofObjects;
 //                                   //  location.replace(empurl)
 //                                   window.location.href = empurl;
    }
      var sortval = $("#Sortvalue").val();
    if (sortval == 1) {
         $("#asc").hide();
        $("#dsc").show();

    } else {
        $("#asc").show();
        $("#dsc").hide();
    }
    function sortTable(order) {
         var table = $("#example");
        var asc = order === 'asc',

        tbody = table.find('tbody');

    tbody.find('tr').sort(function(a, b) {
        if (asc) {
            $("#asc").hide();
        $("#dsc").show();
            return $('td:first', a).text().localeCompare($('td:first', b).text());
        } else {
             $("#asc").show();
        $("#dsc").hide();
            return $('td:first', b).text().localeCompare($('td:first', a).text());
        }
    }).appendTo(tbody);
}



       function deleteFreqUtask(id) {
        $("#UtaskId").val(id);
        $("#deleteFreqUtask").modal("show");

    }
      function RemoveFreqTsk()
      {
          var ut = $("#UtaskId").val();
                $("#" + ut + "").hide();
             $("#deleteFreqUtask").modal("hide");

        $.ajax({

               type: 'POST',
               url: '@Url.Action("RemoveFreqGrpTask", "Task")',
            timeout: 100000000,
            data: {
                UtaskID: ut,


            },
               dataType: "json",
            success: function (json) {


               },
               error: function () {
                   alert("Something went wrong");


               }
           });

    }





    function myFunction(val) {
        var dots = document.getElementById("" + val + "+dots");
        //var dots = "#" + val + "+dots";
        var moreText = document.getElementById("" + val + "+more");
        // var moreText = "#" + val + "+more";
        var btnText = document.getElementById("" + val + "+myBtn");
        //var btnText = "#" + val + "+myBtn";

        if (dots.style.display === "none") {
            dots.style.display = "inline";
            btnText.innerHTML = "Read more";
            moreText.style.display = "none";
        } else {
            dots.style.display = "none";
            btnText.innerHTML = "Read less";
            moreText.style.display = "inline";
        }
    }
</script>
<script>
    $('#sdtimepicker1').timepicker();
    $('#edtimepicker1').timepicker();
    $('#sdtimepicker2').timepicker();
    $('#sdtimepicker7').timepicker();
    $('#edittimepicker7').timepicker();
    $('#edtimepicker2').timepicker();
     function removegrpmember(id) {
        $("#UserId").val(id);
        $("#removegrpmember").modal("show");

    }
      function RemoveMember()
      {
          var ut = $("#UserId").val();
          var gt = $("#groupTaskDetailsId").val();
          var modal = $("#isModal").val();


          $("#removegrpmember").modal("hide");

        $.ajax({

               type: 'POST',
               url: '@Url.Action("RemoveGroupMember", "Task")',
            timeout: 100000000,
            data: {
                sid: ut,
                groupTaskDetailsId: gt,
                isModal:modal,


            },
               dataType: "json",
            success: function (json) {

            $("#" + ut + "").hide();
               },
               error: function () {
                   alert("Something went wrong");


               }
           });

    }
     function SortTickets(type) {
        var ut = $("#UtaskId2").val();
        $("#dd").hide();
          $.ajax({

               type: 'POST',
               url: '@Url.Action("SortGrpTaskTickets", "Task")',
            timeout: 100000000,
            data: {
                UtaskID: ut,
                Type: type,


            },
               dataType: "json",
              success: function (json) {

                  location.reload();

               },
               error: function () {
                   alert("Something went wrong");


               }
           });
    }
    function checktimeperiod() {
         var StartDate = $("#AddStartDate").val();
        var EndDate = $("#AddEndDate").val();
        var TaskStartDate = $("#TaskStartDate").val();
        var TaskEndDate = $("#TaskEndDate").val();

        if ((StartDate != null && StartDate != "") && EndDate != null && EndDate != "")
        {
            if (StartDate < TaskStartDate) {
                $("#ErrorMessage").text("Start date must be equal or greater than Task's start date");
                $("#addtodobtn").attr('disabled', true);
            } else if (EndDate > TaskEndDate) {
                $("#ErrorMessage").text("End date must be equal or less than Task's end date");
                $("#addtodobtn").attr('disabled', true);

            } else if (StartDate > EndDate) {
                $("#ErrorMessage").text("Start date must be less than End date");
                $("#addtodobtn").attr('disabled', true);

            }
            else if (StartDate == EndDate) {
                 var sdtimepicker1 = $("#sdtimepicker1").val();
                var edtimepicker1 = $("#edtimepicker1").val();

                var Sdatetime = StartDate + " " + sdtimepicker1;
                var Edatetime = EndDate + " " + edtimepicker1;

                var s = new Date(Sdatetime);
                var e = new Date(Edatetime);

                var ticks = ((s.getTime() * 10000) + 621355968000000000);
                var ticks2 = ((e.getTime() * 10000) + 621355968000000000);
                if (ticks < ticks2) {
                    $("#addtodobtn").attr('disabled', false);
                    $("#ErrorMessage").text("");
                } else {
                      $("#ErrorMessage").text("Time period must be valid");
                   $("#addtodobtn").attr('disabled', true);
                }

            }  else {
                $("#ErrorMessage").text("");
                $("#addtodobtn").attr('disabled', false);

            }
        }

    }

    function Updatechecktimeperiod() {
         var StartDate = $("#StartDate").val();
        var EndDate = $("#EndDate").val();
        var TaskStartDate = $("#TaskStartDate").val();
        var TaskEndDate = $("#TaskEndDate").val();

        if ((StartDate != null && StartDate != "") && EndDate != null && EndDate != "")
        {
           if (StartDate < TaskStartDate) {
                $("#ErrorMessage2").text("Start date must be equal or greater than Task's start date");
                $("#addtodobtn2").attr('disabled', true);
            } else if (EndDate > TaskEndDate) {
                $("#ErrorMessage2").text("End date must be equal or less than Task's end date");
                $("#addtodobtn2").attr('disabled', true);

            } else if (StartDate > EndDate) {
                $("#ErrorMessage2").text("Start date must be less than End date");
                $("#addtodobtn2").attr('disabled', true);

            }
            else if (StartDate == EndDate) {
                        var sdtimepicker2 = $("#sdtimepicker2").val();
                var edtimepicker2 = $("#edtimepicker2").val();

                var Sdatetime = StartDate + " " + sdtimepicker2;
                var Edatetime = EndDate + " " + edtimepicker2;

                var s = new Date(Sdatetime);
                var e = new Date(Edatetime);

                var ticks = ((s.getTime() * 10000) + 621355968000000000);
                var ticks2 = ((e.getTime() * 10000) + 621355968000000000);
                if (ticks < ticks2) {
                    $("#addtodobtn2").attr('disabled', false);
                    $("#ErrorMessage2").text("");
                } else {
                     $("#ErrorMessage2").text("Time period must be valid");
                    $("#addtodobtn2").attr('disabled', true);

                }



            } else {
                $("#ErrorMessage2").text("");
                $("#addtodobtn2").attr('disabled', false);

            }
        }

    }


     function CheckStartDateEndDate()
    {
        var StartDate = $("#AddStartDate").val();
        var EndDate = $("#AddEndDate").val();
        var TaskStartDate = $("#TaskStartDate").val();
        var TaskEndDate = $("#TaskEndDate").val();

        if ((StartDate != null && StartDate != "") && EndDate != null && EndDate != "")
        {
            if (StartDate < TaskStartDate) {
                $("#ErrorMessage").text("Start date must be equal or greater than Task's start date");
                $("#addtodobtn").attr('disabled', true);
            } else if (EndDate > TaskEndDate) {
                $("#ErrorMessage").text("End date must be equal or less than Task's end date");
                $("#addtodobtn").attr('disabled', true);

            } else if (StartDate > EndDate) {
                $("#ErrorMessage").text("Start date must be less than End date");
                $("#addtodobtn").attr('disabled', true);

            }
            else if (StartDate == EndDate) {
                 var sdtimepicker1 = $("#sdtimepicker1").val();
                var edtimepicker1 = $("#edtimepicker1").val();

                var Sdatetime = StartDate + " " + sdtimepicker1;
                var Edatetime = EndDate + " " + edtimepicker1;

                var s = new Date(Sdatetime);
                var e = new Date(Edatetime);

                var ticks = ((s.getTime() * 10000) + 621355968000000000);
                var ticks2 = ((e.getTime() * 10000) + 621355968000000000);
                if (ticks < ticks2) {
                    $("#addtodobtn").attr('disabled', false);
                    $("#ErrorMessage").text("");
                } else {
                      $("#ErrorMessage").text("Time period must be valid");
                   $("#addtodobtn").attr('disabled', true);
                }
            }
            else {
                $("#ErrorMessage").text("");
                $("#addtodobtn").attr('disabled', false);

            }
        }


    }


    function UpdateCheckStartDateEndDate()
    {
        var StartDate = $("#StartDate").val();
        var EndDate = $("#EndDate").val();
        var TaskStartDate = $("#TaskStartDate").val();
        var TaskEndDate = $("#TaskEndDate").val();

        if ((StartDate != null && StartDate != "") && EndDate != null && EndDate != "")
        {
            if (StartDate < TaskStartDate) {
                $("#ErrorMessage2").text("Start date must be equal or greater than Task's start date");
                $("#addtodobtn2").attr('disabled', true);
            } else if (EndDate > TaskEndDate) {
                $("#ErrorMessage2").text("End date must be equal or less than Task's end date");
                $("#addtodobtn2").attr('disabled', true);

            } else if (StartDate > EndDate) {
                $("#ErrorMessage2").text("Start date must be less than End date");
                $("#addtodobtn2").attr('disabled', true);

            }
            else if (StartDate == EndDate) {
                      var sdtimepicker2 = $("#sdtimepicker2").val();
                var edtimepicker2 = $("#edtimepicker2").val();

                var Sdatetime = StartDate + " " + sdtimepicker2;
                var Edatetime = EndDate + " " + edtimepicker2;

                var s = new Date(Sdatetime);
                var e = new Date(Edatetime);

                var ticks = ((s.getTime() * 10000) + 621355968000000000);
                var ticks2 = ((e.getTime() * 10000) + 621355968000000000);
                if (ticks < ticks2) {
                    $("#addtodobtn2").attr('disabled', false);
                    $("#ErrorMessage2").text("");
                } else {
                     $("#ErrorMessage2").text("Time period must be valid");
                    $("#addtodobtn2").attr('disabled', true);

                }

            }
            else {
                $("#ErrorMessage2").text("");
                $("#addtodobtn2").attr('disabled', false);

            }
        }


    }

      function ValidateCommentText(text,v="no")
    {
        if (v == "yes") {
  var c = text.value.length;
        $("#charCounter").text(500-c);
        }

        var x = $("#TaskId").val();
        $.ajax({

               type: 'POST',
               url: '@Url.Action("TestaddComment", "Task")',
            timeout: 100000000,
            data: {
                comment: text.value,
                taskId:x
            },
               dataType: "json",
               success: function (json) {
                    $('#submit').attr('disabled', false)

               },
               error: function () {
                   alert("Incorrect Input Format")
                   $('#submit').attr('disabled', true)

               }
           });

    }
      function checkstatus() {
        var x = $("#ActiveToDo").val();
        if ($("#status").val() == 4 && x > 0) {
            $("#statuswarn").text("There are some Active To Do's.If you update it they'll turn into Inactive! ");
        } else {
             $("#statuswarn").text("");
        }

    }

  function AdjustIconlist(id) {

        var topcomment = $('#dropupID').val();

        var element = document.getElementById('li_'+topcomment);
  element.classList.remove("dropup");
//        if (id == topcomment) {
//            var style = window.getComputedStyle(document.getElementById('diva'));
// marginTop = style.getPropertyValue('margin-top');
////alert(marginTop);
//            if (marginTop < "120px") {
//                $("#diva").css("margin-top", "120px");
//                i++;
//            } else {
//                $("#diva").css("margin-top", "0px");
//                i = 2;
//            }

//            j = 1;
//        } else
//        {
//             $("#diva").css("margin-top", "0px");
//                i = 2;
//        }


    }

    function AdjustRepliesIconlist(id) {



        var topcomment = $("#RepliesdropupID_" + id + "").val();
          var element = document.getElementById(topcomment);
  element.classList.remove("dropup");

//        if (id == topcomment) {
//            var style = window.getComputedStyle(document.getElementById("divrep_"+ id+""));
// marginTop1 = style.getPropertyValue('margin-top');
////alert(marginTop);
//            if (marginTop1 < "120px") {
//                $("#divrep_"+ id+"").css("margin-top", "120px");
//                k++;
//            } else {
//                $("#divrep_"+ id+"").css("margin-top", "0px");
//                k = 2;
//            }

//            l = 1;
//        } else
//        {
//             $("#divrep_"+ id+"").css("margin-top", "0px");
//                i = 2;
//        }


    }


    //////////////////////////////////////////////////
    $('#replycomment').hide();
    $('#cancelreplybtn').hide();
    $('.rreply').hide();
    function commentreplies(id)
    {
        $("#" + id + "").toggle();
         window.location = "#f_" + id + "";
    }
    function showreply(cmntid)
    {
        $.ajax({
            type: 'POST',
            url: "../task/getReplyGroupComment",
            data: { cmntid: cmntid },
            dataType: "json",
            success: function (data) {
                // get role of the user then if you are an admin then assign tasks to manager and employee
                // if you are manager then assign to employee
                // if you can self assign
                $("#replycomment").val("");
                if (data.Id != 0) {
                $("#replycomment").val(data.Comment);
                $("#repcomntid").val(data.Id);



                $('#replycomment').show();
                    $('#cancelreplybtn').show();


                     window.location = "#yourcomment";
                $("#grpcomment").focus();
            }

            },
            error: function () { alert('fail'); }
        });

    }
    function cancelreply()
    {
        $('#replycomment').hide();
        $('#cancelreplybtn').hide();
         $("#repcomntid").val("");
    }


      if ($('#viewrepliesId').val()!= -1) {
          var x = $('#viewrepliesId').val();
          $("#" + x + "").show();
        window.location = "#" + x + "";
    }
     if ($('#replyId').val()!= -1) {
          var x = $('#replyId').val();
         // $("#" + x + "").show();
         if (x) {
             window.location = "#yourcomment";
             var cmntid = x;

             $.ajax({
                 type: 'POST',
                 url: "../task/getReplyGroupComment",
                 data: { cmntid: cmntid },
                 dataType: "json",
                 success: function (data) {
                     // get role of the user then if you are an admin then assign tasks to manager and employee
                     // if you are manager then assign to employee
                     // if you can self assign
                     $("#replycomment").val("");

                     $("#replycomment").val(data.Comment);
                     $("#repcomntid").val(data.Id);



                     $('#replycomment').show();
                     $('#cancelreplybtn').show();


                 },
                 error: function () { alert('fail'); }
             });
         }

    }

    //////////////////////////////////////////////////




    $("#grpreplycomment").hide();
    //function showreply() {
    //    $("#grpreplycomment").show();
    //   // var x = $("#commentvalue").val();
    //    $("#grpreplycomment").val();

    //}

    $("#Submit").attr("disabled", true);
     var x = false;

    function btnfile(file)
    {
        var FileSize = file.files[0].size / 1024 / 1024; // in MB
        if (file.value != "")
        {

            if (FileSize > 2)
            {
                $('#errorMessageCmt').text('File size exceeds 2 MBs');

                $('#Submit').attr("disabled", true);
            }
            else
            {
                $('#errorMessageCmt').text('');

                $('#Submit').attr("disabled", false);
            }
            //$("#Submit").attr("disabled", false);
        }
        else
        {

            if ($("#grpcomment").val() != "")
            {
                $("#Submit").attr("disabled", false);
            }
            else
            {
                $("#Submit").attr("disabled", true);
            }
        }
    }

    function btncomment(title) {
          var c = title.value.length;
        $("#charCounter").text(500-c);
               var x = "gdfgf";
        $.ajax({

               type: 'POST',
               url: '@Url.Action("TestaddComment", "Task")',
            timeout: 100000000,
            data: {
                comment: title.value,
                taskId:x
            },
               dataType: "json",
               success: function (json) {
                    $('#submit').attr('disabled', false)

               },
               error: function () {
                   alert("Incorrect Input Format")
                   $('#submit').attr('disabled', true)

               }
           });


        if (title.value != "") {
            $("#Submit").attr("disabled", false);
        } else
        {

                if ($("#grpfile").val() != "")
            {
            $("#Submit").attr("disabled", false);
            } else
            {

                 $("#Submit").attr("disabled", true);
            }
        }
    }
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
<script type="text/javascript">




    function linethrough(id, obj) {
        if ($("#" + obj.id).is(":checked")) {
            $("." + id).css("text-decoration", "line-through");
        }
        else {
            $("." + id).css("text-decoration", "none");
        }

    }
    var lat = $("#late").val();
    if (lat == 2) {
        var dt = $("#datep").val();

        // Set the date we're counting down to
        var countDownDate = new Date(dt).getTime();

        // Update the count down every 1 second
        var x = setInterval(function () {

            // Get todays date and time
            var now = new Date().getTime();

            // Find the distance between now and the count down date
            var distance = countDownDate - now;

            // Time calculations for days, hours, minutes and seconds
            var days = Math.floor(distance / (1000 * 60 * 60 * 24));
            var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Output the result in an element with id="demo"

            document.getElementById("d").innerHTML = days + "d ";
            document.getElementById("h").innerHTML = hours + "h ";
            document.getElementById("m").innerHTML = minutes + "m ";
            document.getElementById("s").innerHTML = seconds + "s ";

       // If the count down is over, write some text
        //if (distance < 0) {
        //    clearInterval(x);
        //    document.getElementById("expire").innerHTML = "LATE";
        //}
    }, 1000);
    }
    ; (function ($) {

        'use strict';

        $('.alert[data-auto-dismiss]').each(function (index, element) {
            var $element = $(element),
                timeout = $element.data('auto-dismiss') || 2000;

            setTimeout(function () {
                $element.alert('close');
            }, timeout);
        });

    })(jQuery);
    $('#requestButton').click(function () {
        $('#requestDiv').hide();
    });

    function updateValue(response) {
        $('#responseid').val(response);
        $('#requestmethod').submit();
    }

    function updatToDo(id) {
        $('#ticketId').val(id);
        $('#completetciketmodal').modal("show");
    }

    function editToDo(id,IsDocMFile) {

           var name = $("#editname_" + id + "").val();
        var sd=$("#editsdate_" + id + "").val();
        var st=$("#editstime_" + id + "").val();
        var ed=$("#editedate_" + id + "").val();
        var et=$("#editetime_" + id + "").val();

        if (name.indexOf(" qqqqaaaa ")) {
            $sttr = name.replace(" qqqqaaaa ", " ");
             $('#todoName').val($sttr);
        } else {
             $('#todoName').val(name);
        }
        $('#ticket_Id').val(id);

            $('#StartDate').val(sd);
       // $('#StartDate').val(sd);
        $('#EndDate').val(ed);
        if (st != null && st != "") {
            var starttime = st.split(' ')[1];

            var starttimeAMPM = st.split(' ')[2];
            var st1 = starttime.split(':')[0];
            var st2 = starttime.split(':')[1];
            st = st1 + ":" + st2 + " " + starttimeAMPM;
            $('#sdtimepicker2').val(st);
        } else
        {
              $('#sdtimepicker2').val();
        }

        if (et != null && et != "") {
            var endtime = et.split(' ')[1];

            var endtimeAMPM = et.split(' ')[2];
            var et1 = endtime.split(':')[0];
            var et2 = endtime.split(':')[1];
            et = et1 + ":" + et2 + " " + endtimeAMPM;
            $('#edtimepicker2').val(et);


        } else {
            $('#edtimepicker2').val();
        }
        //et = et.split(' ')[1];

         //Setting the text in edit todo if file already exists -- Wajeeh
         if (IsDocMFile == "1") {
            $("#customText4").text("Update path:(File exists in document manager)");
        }
        else {
            $("#customText4").text("Select Custom File Location:");
        }


        $('#edittodomodal').modal("show");
        UpdateCheckStartDateEndDate();
    }

    function deleteToDo(id) {
        $('#ticketid').val(id);
        $('#deletetodomodal').modal("show");
    }

    function displayAddMember() {
        var dd = $('#hidDiviId').val();
        $('#divisionId').val(dd);
        $('#addmemberModal').modal("show");
    }

    function editComment(text, id, ism, isFile, IsDocMFile) {
        $('#removeExistingFile').attr('disabled', false);
        if (isFile == '') {
            document.getElementById('removeExistingFile').style.visibility = 'hidden';
            $('#upLoad').innerHtml='Upload File';
        }
        else {
            document.getElementById('removeExistingFile').style.visibility = 'visible';
            $('#upLoad').innerHtml='Upload New File';
        }
        $('#editText').val(text);

           //Setting the text in edit todo if file already exists -- Wajeeh
        if (IsDocMFile == "1") {
            $("#customText").text("Update path:(File exists in document manager)");
        }
        else {
            $("#customText").text("Select Custom File Location:");
        }

        $('#commentId').val(id);
        $('#isManag').val(ism);
        $('#editComment').modal("show");
    }

    function deleteComment(id, ism) {
        $('#commentId1').val(id);
        $('#isManag1').val(ism);
        $('#deleteComment').modal("show");
    }

    function displayEmp(vid) {
        if (vid == 1) {
            $('#divmang').show();
            $('#divemp').hide();
            $('#divadmin').hide();
            $("#emp").val(-1);
            $("#admin").val(-1);
        }
        else if (vid == 2) {

            $('#divmang').hide();
            $('#divemp').show();
            $('#divadmin').hide();
            $("#mang").val(-1);
            $("#admin").val(-1);
        } else if (vid == 3) {
            $('#divmang').hide();
            $('#divemp').hide();
            $('#divadmin').show();
            $("#mang").val(-1);
            $("#emp").val(-1);

        }


    }

    function addMembers(sid) {

        var dd = $('#hidDiviId').val();


        $.ajax({

               type: 'POST',
               url: '@Url.Action("getDivisionEmp,Task")',
            data: { _sid: sid, _did:dd },
               dataType: "json",
            success: function (json) {
                $('#member').empty();

                $.each(data, function (index) {
                    $('#member').append('<option value=' + data[0] + '> ' + data[1] + '</option');
                });


               },
               error: function (data) {

                   $('.loading3').hide();
                   $('#curvechart_error').show();
                   $('#curve_chart').hide();
               }
           });
    }

    function changeFileStatus() {
        $('#removeFile').val(1);
        $('#removeExistingFile').attr('disabled', true);
    }
</script>
<script>



    var msgBody = document.querySelector('#commentsscroll');
    msgBody.scrollTop = msgBody.scrollHeight - msgBody.clientHeight;
</script>


<script>
    //functions used to limit the upload file size by 2 mbs in comment, update comment and Todo Sections
    function ValidateSizeComment(file) {
        var FileSize = file.files[0].size / 1024 / 1024; // in MB
        if (FileSize > 10) {
            $('#errorMessageCmt').text('File size exceeds 10 MBs');

            $('#submit').attr("disabled", true);
        } else {
            $('#errorMessageCmt').text('');

            $('#submit').attr("disabled", false);
        }
    }

    function ValidateSizeCommentUpd(file) {
        var FileSize = file.files[0].size / 1024 / 1024; // in MB
        if (FileSize > 10) {
            $('#errorMessageCmtUpd').text('File size exceeds 10 MBs');

            $('#submitUpd').attr("disabled", true);
        } else {
            $('#errorMessageCmtUpd').text('');

            $('#submitUpd').attr("disabled", false);
        }
    }

    function ValidateSizeCommentReply(file) {
        var FileSize = file.files[0].size / 1024 / 1024; // in MB
        if (FileSize > 10) {
            $('#errorMessageCmtReply').text('File size exceeds 10 MBs');

            $('#submitReply').attr("disabled", true);
        } else {
            $('#errorMessageCmtReply').text('');

            $('#submitReply').attr("disabled", false);
        }
    }


    function ValidateSizeTodo(file) {
        var FileSize = file.files[0].size / 1024 / 1024; // in MB
        if (FileSize > 10) {
            $('#errorMessageTodo').text('File size exceeds 10 MBs');

            $('#addtodobtn').attr("disabled", true);
        } else {
            $('#errorMessageTodo').text('');

            $('#addtodobtn').attr("disabled", false);
        }
    }

    function ValidateSizeTodoUpd(file) {
        var FileSize = file.files[0].size / 1024 / 1024; // in MB
        if (FileSize > 10) {
            $('#errorMessageTodoUpd').text('File size exceeds 10 MBs');

            $('#addtodobtn2').attr("disabled", true);
        } else {
            $('#errorMessageTodoUpd').text('');

            $('#addtodobtn2').attr("disabled", false);
        }
    }
</script>


<script>

    var activetodos = '@activetodos';
    var completedtodos = '@completedtodos';

    var config = {
        type: 'doughnut',
        data: {
            datasets: [{
                data: [
                    parseInt(activetodos),
                    parseInt(completedtodos),

                ],
                backgroundColor: [
                    window.chartColors.red,
                    window.chartColors.green,
                ],
                label: 'Dataset 1'
            }],
            labels: [
                'Active Todos',
                'Completed Todos'
            ]
        },
        options: {
            responsive: true,
            legend: {
                position: 'top',
            },
            title: {
                display: false,
                text: 'Todos'
            },
            animation: {
                animateScale: true,
                animateRotate: true
            }
        }
    };

    window.onload = function () {
        var ctx = document.getElementById('chart-area').getContext('2d');
        window.myDoughnut = new Chart(ctx, config);
    };


</script>


<script>

    //Getting Files From Document Manager for Comments
    function GetDocMFilesCmt() {

        $("#spinnerCmt").show();

        $.ajax({
            type: 'POST',
            url: "../Task/GetDocMFiles",
            dataType: "json",
            success: function (data) {
                // get role of the user then if you are an admin then assign tasks to manager and employee
                // if you are manager then assign to employee
                // if you can self assign
                //var role = data[0].SessionRole;
                $("#DocMIDCmt").html("");
                var count = 0;
                $('#DocMIDCmt').empty();
                $('#DocMIDCmt').append('<option value="" selected > Please Choose a Doc Manager File</option>');
                for (var i = 0; i < data.length; i++) {
                    var division = '<option value="' + data[i]['Id'] + '">' + data[i]['Name'] + '</option>';
                    $('#DocMIDCmt').append(division);
                }
                $("#spinnerCmt").hide();
                $("#FileDivCmt").show();

            },
            error: function () { $("#AjaxErrorModal").modal("show"); }
        });
    }

    function FileDivCmt() {
        if (document.getElementById("IsDocFileCmt").checked == true) {

            //Hiding selecting location button -- Wajeeh
            $("#customLocPath").val("");
            $("#customLocPathHidden").val("");
            $("#customLocPathMainBtn").hide();

            GetDocMFilesCmt();
        }
        else {

            //Showing selecting location button -- Wajeeh
            $("#customLocPath").val("");
            $("#customLocPathHidden").val("");
            $("#customLocPathMainBtn").show();

            $("#FileDivCmt").hide();
            $("#spinnerCmt").hide();
        }
    }
    //Getting Files From Document Manager for Comments



    //Getting Files From Document Manager for Comments Reply
    function GetDocMFilesCmtRply(id) {
        $("#spinnerCmtRply" + id).show();

        $.ajax({
            type: 'POST',
            url: "../Task/GetDocMFiles",
            dataType: "json",
            success: function (data) {
                // get role of the user then if you are an admin then assign tasks to manager and employee
                // if you are manager then assign to employee
                // if you can self assign
                //var role = data[0].SessionRole;
                $("#DocMIDCmtRply").html("");
                var count = 0;
                $('#DocMIDCmtRply').empty();
                $('#DocMIDCmtRply').append('<option value="" selected > Please Choose a Doc Manager File</option>');
                for (var i = 0; i < data.length; i++) {
                    var division = '<option value="' + data[i]['Id'] + '">' + data[i]['Name'] + '</option>';
                    $('#DocMIDCmtRply').append(division);
                }
                $("#spinnerCmtRply" + id).hide();
                $("#FileDivCmtRply" + id).show();

            },
            error: function () { $("#AjaxErrorModal").modal("show"); }
        });
    }

    function FileDivCmtRply(id) {
        if (document.getElementById("IsDocFileCmtRply" + id).checked == true) {

            //Hiding selecting location button -- Wajeeh
            $("#customLocPath" + id).val("");
            $("#customLocPathHidden" + id).val("");
            $("#customLocPathMainBtn" + id).hide();

            GetDocMFilesCmtRply(id);

        } else {

            //Showing selecting location button -- Wajeeh
            $("#customLocPath" + id).val("");
            $("#customLocPathHidden" + id).val("");
            $("#customLocPathMainBtn" + id).show();

            $("#FileDivCmtRply" + id).hide();
            $("#spinnerCmtRply" + id).hide();
        }
    }
    //Getting Files From Document Manager for Comments Reply



    //Getting Files From Document Manager for Comments Update
    function GetDocMFilesCmtUpd() {

        $("#spinnerCmtUpd").show();

        $.ajax({
            type: 'POST',
            url: "../Task/GetDocMFiles",
            dataType: "json",
            success: function (data) {
                // get role of the user then if you are an admin then assign tasks to manager and employee
                // if you are manager then assign to employee
                // if you can self assign
                //var role = data[0].SessionRole;
                $("#DocMIDCmtUpd").html("");
                var count = 0;
                $('#DocMIDCmtUpd').empty();
                $('#DocMIDCmtUpd').append('<option value="" selected > Please Choose a Doc Manager File</option>');
                for (var i = 0; i < data.length; i++) {
                    var division = '<option value="' + data[i]['Id'] + '">' + data[i]['Name'] + '</option>';
                    $('#DocMIDCmtUpd').append(division);
                }
                $("#spinnerCmtUpd").hide();
                $("#FileDivCmtUpd").show();

            },
            error: function () { $("#AjaxErrorModal").modal("show"); }
        });
    }

    function FileDivCmtUpd() {
        if (document.getElementById("IsDocFileCmtUpd").checked == true) {

            //Hiding selecting location button -- Wajeeh
            $("#customLocPath1").val("");
            $("#customLocPathHidden1").val("");
            $("#customLocPathMainBtn1").hide();

            GetDocMFilesCmtUpd();
        }
        else {

            //Showing selecting location button -- Wajeeh
            $("#customLocPath1").val("");
            $("#customLocPathHidden1").val("");
            $("#customLocPathMainBtn1").show();

            $("#FileDivCmtUpd").hide();
            $("#spinnerCmtUpd").hide();
        }
    }
    //Getting Files From Document Manager for Comments update




    //Getting Files From Document Manager for Todo
    function GetDocMFilesTodo() {

        $("#spinnerTodo").show();

        $.ajax({
            type: 'POST',
            url: "../Task/GetDocMFiles",
            dataType: "json",
            success: function (data) {
                // get role of the user then if you are an admin then assign tasks to manager and employee
                // if you are manager then assign to employee
                // if you can self assign
                //var role = data[0].SessionRole;
                $("#DocMIDTodo").html("");
                var count = 0;
                $('#DocMIDTodo').empty();
                $('#DocMIDTodo').append('<option value="" selected > Please Choose a Doc Manager File</option>');
                for (var i = 0; i < data.length; i++) {
                    var division = '<option value="' + data[i]['Id'] + '">' + data[i]['Name'] + '</option>';
                    $('#DocMIDTodo').append(division);
                }
                $("#spinnerTodo").hide();
                $("#FileDivTodo").show();

            },
            error: function () { $("#AjaxErrorModal").modal("show"); }
        });
    }

    function FileDivTodo() {
        if (document.getElementById("IsDocFileTodo").checked == true) {

            //Hiding selecting location button -- Wajeeh
            $("#customLocPath3").val("");
            $("#customLocPathHidden3").val("");
            $("#customLocPathMainBtn3").hide();

            GetDocMFilesTodo();
        }
        else {

            //Showing selecting location button -- Wajeeh
            $("#customLocPath3").val("");
            $("#customLocPathHidden3").val("");
            $("#customLocPathMainBtn3").show();

            $("#FileDivTodo").hide();
            $("#spinnerTodo").hide();
        }
    }
    //Getting Files From Document Manager for Todo




    //Getting Files From Document Manager for Todo Update
    function GetDocMFilesTodoUpd() {

        $("#spinnerTodoUpd").show();

        $.ajax({
            type: 'POST',
            url: "../Task/GetDocMFiles",
            dataType: "json",
            success: function (data) {
                // get role of the user then if you are an admin then assign tasks to manager and employee
                // if you are manager then assign to employee
                // if you can self assign
                //var role = data[0].SessionRole;
                $("#DocMIDTodoUpd").html("");
                var count = 0;
                $('#DocMIDTodoUpd').empty();
                $('#DocMIDTodoUpd').append('<option value="" selected > Please Choose a Doc Manager File</option>');
                for (var i = 0; i < data.length; i++) {
                    var division = '<option value="' + data[i]['Id'] + '">' + data[i]['Name'] + '</option>';
                    $('#DocMIDTodoUpd').append(division);
                }
                $("#spinnerTodoUpd").hide();
                $("#FileDivTodoUpd").show();

            },
            error: function () { $("#AjaxErrorModal").modal("show"); }
        });
    }

    function FileDivTodoUpd() {
        if (document.getElementById("IsDocFileTodoUpd").checked == true) {

            //Hiding selecting location button -- Wajeeh
            $("#customLocPath4").val("");
            $("#customLocPathHidden4").val("");
            $("#customLocPathMainBtn4").hide();

            GetDocMFilesTodoUpd();
        }
        else {

            //Showing selecting location button -- Wajeeh
            $("#customLocPath4").val("");
            $("#customLocPathHidden4").val("");
            $("#customLocPathMainBtn4").show();

            $("#FileDivTodoUpd").hide();
            $("#spinnerTodoUpd").hide();
        }
    }
    //Getting Files From Document Manager for Todo Update

</script>

<!-- Wajeeh Script starts for document manager custom folder location -->

<script>

    function selectFolderFromDocM(j, check, ff) {

        var b = -1;

        $("#createNewFolInput").val("");
        $("#createNewFolInput").hide();
        $("#createNewFolSubmitBtn").removeAttr("onclick");
        $("#createNewFolSubmitBtn").hide();
        $("#createNewFolHidden").val("");
        $("#createNewFolLink").removeAttr("onclick");
        $("#folErr").hide();
        //$("#createNewCrossBtn").hide();

        $("#breadCrumbDiv").html("");

        $("#moveDirectoryTbl > tbody").html("");

        //getting all folders list for breadcrumbs
        $.ajax({
            url: "../Manager/get_allfolders",
            type: "POST",
            dataType: "json",
            success: function (allFolders) {

                //now we get all folders
                var folders = allFolders;

                //preparing breadcrumbs
                $("#breadCrumbDiv").append("<li><a class='active' style='font-weight: 700;'><i class='icon-home2 position-left'></i> Home</a></li>");

                //create folder link event binding
                $("#createNewFolLink").removeAttr("onclick");
                $("#createNewFolLink").attr("onclick", "createFolder(" + b + "," + check + "," + ff + ")");
                $("#createNewFolLink").show();

                //appending home link
                $("#selectHomeLink").removeAttr("onclick");
                var jha = -1;
                $("#selectHomeLink").attr("onclick", "getSelectFolderPath(" + jha + "," + check + "," + ff + ")");
                $("#selectHomeLink").show();

                //getting home/root folders
                var currentHierarchyFolders = $.grep(folders, function (fol) {
                    return fol.ParentId === null && fol.IsActive === 1;
                });

                //appending folders
                $("#moveDirectoryTbl > tbody").html("");
                var i = 0;
                var trobject = "";
                $.each(currentHierarchyFolders, function () {
                    trobject = '<tr style="width:100% !important"><td style="width: 35% !important;"><a onclick="selectBreadCrumbFolder(' + currentHierarchyFolders[i].Id + ',' + check + ',' + ff + ')"><i class="icon-folder iconStyle"></i>' + currentHierarchyFolders[i].Name + '</a></td><td style="width: 20% !important;" class="text-center"><a onclick="getSelectFolderPath(' + currentHierarchyFolders[i].Id + ',' + check + ',' + ff + ')" class="btn btn-sm bg-primary-300">Select</a></td>';
                    trobject = trobject + '</tr>';
                    $('#moveDirectoryTbl > tbody:last-child').append(trobject);
                    i++;
                });

                if (j == -1 || j == undefined || j == null) {
                    $("#moveDirectoryModal").modal("show");
                }

            },
            error: function () { $("#AjaxErrorModal").modal("show"); }
        });
    }

    function selectBreadCrumbFolder(parent, check, ff) {

        var j = 1;

        $("#createNewFolInput").val("");
        $("#createNewFolInput").hide();
        $("#createNewFolSubmitBtn").removeAttr("onclick");
        $("#createNewFolSubmitBtn").hide();
        $("#createNewFolHidden").val("");
        $("#createNewFolLink").removeAttr("onclick");
        $("#folErr").hide();
        //$("#createNewCrossBtn").hide();

        $("#breadCrumbDiv").html("");

        $("#moveDirectoryTbl > tbody").html("");

        $.ajax({
            url: "../Manager/get_allfolders",
            type: "POST",
            dataType: "json",
            success: function (allFolders) {

                //now we get all folders
                var folders = allFolders;

                //preparing breadcrumbs
                var parentFolder = $.grep(folders, function (obj) { return obj.Id === parent; })[0];
                var breadCrumbs = [];
                breadCrumbs = parentFolder.FolderPath.split(",");

                for (var i = 0; i < breadCrumbs.length; i++) {

                    var folder = $.grep(folders, function (obj) { return obj.Id.toString() === breadCrumbs[i]; })[0];

                    if (i == 0) {
                        $("#breadCrumbDiv").append("<li><a onclick='selectFolderFromDocM(" + j + "," + check + "," + ff + ")' class='active'><i class='icon-home2 position-left'></i> Home</a></li>");
                    }
                    if (breadCrumbs[i] == parent) {
                        $("#breadCrumbDiv").append("<li style='font-weight: 700;'><a class='active' onclick='selectBreadCrumbFolder(" + folder.Id + "," + check + "," + ff + ")'>" + folder.Name + "</a></li>");
                    }
                    else {
                        $("#breadCrumbDiv").append("<li style='font-weight: 700;'><a class='active' onclick='selectBreadCrumbFolder(" + folder.Id + "," + check + "," + ff + ")'>" + folder.Name + "</a></li>");
                    }
                }

                //create folder link event binding
                $("#createNewFolLink").removeAttr("onclick");
                $("#createNewFolLink").attr("onclick", "createFolder(" + parent + "," + check + "," + ff + ")");
                $("#createNewFolLink").show();

                //appending home link
                $("#selectHomeLink").removeAttr("onclick");
                var jha = -1;
                $("#selectHomeLink").attr("onclick", "getSelectFolderPath(" + jha + "," + check + "," + ff + ")");
                $("#selectHomeLink").show();

                //selecting folders
                var currentHierarchyFolders = $.grep(folders, function (fol) {
                    if (fol.ParentId != null) {
                        return fol.ParentId === parent && fol.IsActive === 1;
                    }
                });

                //appending folders
                $("#moveDirectoryTbl > tbody").html("");
                var i = 0;
                var trobject = "";
                $.each(currentHierarchyFolders, function () {
                    trobject = '<tr style="width:100% !important"><td style="width: 35% !important;"><a onclick="selectBreadCrumbFolder(' + currentHierarchyFolders[i].Id + ',' + check + ',' + ff + ')" ><i class="icon-folder iconStyle"></i> ' + currentHierarchyFolders[i].Name + '</a></td><td style="width: 20% !important;" class="text-center"><a onclick="getSelectFolderPath(' + currentHierarchyFolders[i].Id + ',' + check + ',' + ff + ')" class="btn btn-sm bg-primary-300">Select</a></td>';
                    trobject = trobject + '</tr>';
                    $('#moveDirectoryTbl > tbody:last-child').append(trobject);
                    i++;
                });

            }
        });
    }

    function createFolder(parentId, check, ff) {

        $("#createNewFolHidden").val(parentId);
        parentId = $("#createNewFolHidden").val();
        $("#createNewFolLink").removeAttr("onclick");
        $("#createNewFolInput").show();
        $("#createNewFolSubmitBtn").attr("onclick", "submitFolder(" + parentId + "," + check + "," + ff + ")");
        $("#createNewFolSubmitBtn").show();

    }

    function submitFolder(parentId, check, ff) {

        var name = $("#createNewFolInput").val();

        if (name == "" || name == undefined || name == null) {
            $("#folErr").show().delay(2000).fadeOut();
        }
        else {
            $.ajax({
                type: 'POST',
                url: "../Manager/CreateFolder",
                dataType: "json",
                data: {
                    ParentId: parentId,
                    Name: name
                },
                success: function (data) {
                    $('#folGenMsg').text("Directory Created!").show().delay(2000).fadeOut();
                    $("#createNewFolInput").val("");
                    $("#createNewFolInput").hide();
                    $("#createNewFolSubmitBtn").removeAttr("onclick");
                    $("#createNewFolSubmitBtn").hide();
                    $("#createNewFolHidden").val("");
                    $("#createNewFolLink").removeAttr("onclick");
                    $("#folErr").hide();


                    if (parentId == -1) {
                        selectFolderFromDocM('-1', check, ff);
                    }
                    else {
                        selectBreadCrumbFolder(parentId, check, ff);
                    }
                },
                error: function (jqXHR, exception) {
                    console.log(jqXHR.responseText);
                    $("#folGenErr").text(jqXHR.responseText);
                    $("#createNewFolInput").val("");
                    $('#folGenErr').show().delay(2000).fadeOut();
                    $("#AjaxErrorModal").modal("show");
                }
            });
        }
    }

    function getSelectFolderPath(FolderId, check, ff) {
        $.ajax({
            url: "../Manager/get_folder",
            type: "POST",
            dataType: "json",
            data: {
                Id: FolderId
            },
            success: function (folder) {

                if (check == 0) {
                    $("#customLocPath").val(folder.PathText);
                    $("#customLocPathHidden").val(folder.Id);
                    $("#customLocPathDiv").show();

                }
                else if (check == 1) {
                    $("#customLocPath1").val(folder.PathText);
                    $("#customLocPathHidden1").val(folder.Id);
                    $("#customLocPathDiv1").show();

                }
                else if (check == 2) {
                    $("#customLocPath2").val(folder.PathText);
                    $("#customLocPathHidden2").val(folder.Id);
                    $("#customLocPathDiv2").show();

                }
                else if (check == 3) {
                    $("#customLocPath3").val(folder.PathText);
                    $("#customLocPathHidden3").val(folder.Id);
                    $("#customLocPathDiv3").show();

                }
                else if (check == 4) {
                    $("#customLocPath4").val(folder.PathText);
                    $("#customLocPathHidden4").val(folder.Id);
                    $("#customLocPathDiv4").show();

                }
                else if (check == 45) {
                    $("#customLocPath" + ff).val(folder.PathText);
                    $("#customLocPathHidden" + ff).val(folder.Id);
                    $("#customLocPathDiv" + ff).show();
                }

                $("#moveDirectoryModal").modal("hide");

            },
            error: function (jqXHR, exception) {

                if (check == 0) {
                    $("#customLocPath").val("");
                    $("#customLocPathHidden").val("");

                }
                else if (check == 1) {
                    $("#customLocPath1").val("");
                    $("#customLocPathHidden1").val("");

                }
                else if (check == 2) {
                    $("#customLocPath2").val("");
                    $("#customLocPathHidden2").val("");

                }
                else if (check == 3) {
                    $("#customLocPath3").val("");
                    $("#customLocPathHidden3").val("");

                }
                else if (check == 4) {
                    $("#customLocPath4").val("");
                    $("#customLocPathHidden4").val("");

                }
                else if (check == 45) {
                    $("#customLocPath" + ff).val("");
                    $("#customLocPathHidden" + ff).val("");
                }

                alert(jqXHR.responseText);
                $("#AjaxErrorModal").modal("show");
            }
        });
    }

    function removeSelectFolderPath(check, ff) {
        if (check == 0) {
            $("#customLocPath").val("");
            $("#customLocPathHidden").val("");
            $("#customLocPathDiv").hide();
        }
        else if (check == 1) {
            $("#customLocPath1").val("");
            $("#customLocPathHidden1").val("");
            $("#customLocPathDiv1").hide();
        }
        else if (check == 2) {
            $("#customLocPath2").val("");
            $("#customLocPathHidden2").val("");
            $("#customLocPathDiv2").hide();
        }
        else if (check == 3) {
            $("#customLocPath3").val("");
            $("#customLocPathHidden3").val("");
            $("#customLocPathDiv3").hide();
        } else if (check == 4) {
            $("#customLocPath4").val("");
            $("#customLocPathHidden4").val("");
            $("#customLocPathDiv4").hide();
        }
        else if (check == 45) {
            $("#customLocPath" + ff).val("");
            $("#customLocPathHidden" + ff).val("");
            $("#customLocPathDiv" + ff).hide();
        }
    }


</script>

<!-- Wajeeh Script ends for selecting custom location in document manager -->
